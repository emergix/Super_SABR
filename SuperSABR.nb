(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    232975,       5573]
NotebookOptionsPosition[    225452,       5332]
NotebookOutlinePosition[    225853,       5349]
CellTagsIndexPosition[    225810,       5346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell["Procedures generiques ", "Section",
 CellChangeTimes->{{3.442574141349803*^9, 3.4425741470683336`*^9}}],

Cell[CellGroupData[{

Cell["Vol Deterministe", "Subsection",
 CellChangeTimes->{{3.442576259112228*^9, 3.442576281876979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LocalVolCall", "[", 
   RowBox[{
   "CC_", ",", "CCDev1_", ",", "CCDev2_", ",", "CCInvInteg_", ",", "F_", ",", 
    "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w", ",", "H1", ",", "H2", ",", "Q", ",", "fav"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fav", "=", 
      FractionBox[
       RowBox[{"F", "+", "K"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{"2", " ", "T"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CCInvInteg", "[", "K", "]"}], "-", 
         RowBox[{"CCInvInteg", "[", "F", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H1", "=", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           SuperscriptBox["w", "2"]}]], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"\[Pi]", " ", 
            SuperscriptBox["w", "2"]}]], 
          RowBox[{"(", 
           RowBox[{"NormDis", "[", 
            RowBox[{
             RowBox[{
              SqrtBox["2"], 
              RowBox[{"Abs", "[", "w", "]"}]}], "-", "1"}], "]"}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H2", "=", 
      RowBox[{
       FractionBox["2", "3"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            SuperscriptBox["w", "2"]}]], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", 
             SuperscriptBox["w", "2"]}]}], ")"}]}], "-", 
         RowBox[{"2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Abs", "[", "w", "]"}], ")"}], "3"], 
          SqrtBox["\[Pi]"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"NormDis", "[", 
             RowBox[{
              SqrtBox["2"], 
              RowBox[{"Abs", "[", "w", "]"}]}], "]"}], "-", "1"}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"CC", "[", "fav", "]"}], "2"], "4"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"CCDev2", "[", "fav", "]"}], 
           RowBox[{"CC", "[", "fav", "]"}]], ")"}], "-", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"CCDev1", "[", "fav", "]"}], 
             RowBox[{"CC", "[", "fav", "]"}]], ")"}], "2"]}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F", "-", "K"}], ",", "0"}], "]"}], "+", 
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{
          RowBox[{"CC", "[", "K", "]"}], " ", 
          RowBox[{"CC", "[", "F", "]"}], " ", "T"}]], 
        RowBox[{"2", 
         SqrtBox[
          RowBox[{"2", "\[Pi]"}]]}]], 
       RowBox[{"(", 
        RowBox[{"H1", "+", 
         RowBox[{"T", " ", "H2", " ", "Q"}]}], ")"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4379816086187077`*^9, 3.4379820066528454`*^9}, {
   3.4379820839784956`*^9, 3.4379824133273315`*^9}, {3.4380043830934467`*^9, 
   3.43800438598113*^9}, {3.438004761503146*^9, 3.438004764470395*^9}, {
   3.438004897349214*^9, 3.4380049576580343`*^9}, 3.4380876124558325`*^9, {
   3.4380953307930093`*^9, 3.4380953318398104`*^9}, {3.4380959196421766`*^9, 
   3.438095927016657*^9}, {3.438095959389378*^9, 3.4380961374393425`*^9}, {
   3.4380962328545*^9, 3.4380962388384533`*^9}, {3.4383243506664333`*^9, 
   3.438324355244412*^9}, 3.4394070389983263`*^9, {3.4394070740615683`*^9, 
   3.439407096451062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LocalVolBSVol", "[", 
   RowBox[{
   "CC_", ",", "CCDev1_", ",", "CCDev2_", ",", "CCInvInteg_", ",", "\[Rho]_", 
    ",", "\[Nu]_", ",", "F_", ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w", ",", "H1", ",", "H2", ",", "Q", ",", "fav", ",", "b1", ",", "b2", 
      ",", "b3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fav", "=", 
      FractionBox[
       RowBox[{"F", "+", "K"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "[", "fav", "]"}], ")"}], "2"], "24"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", 
           RowBox[{"CCDev2", "[", "fav", "]"}]}], 
          RowBox[{"CC", "[", "fav", "]"}]], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"CCDev1", "[", "fav", "]"}], 
            RowBox[{"CC", "[", "fav", "]"}]], ")"}], "2"], "+", 
         FractionBox["1", 
          SuperscriptBox["fav", "2"]]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        RowBox[{"K", "/", "F"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CCInvInteg", "[", "K", "]"}], "-", 
         RowBox[{"CCInvInteg", "[", "F", "]"}]}], ")"}]], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"T", " ", 
         RowBox[{"(", "b3", ")"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441963296725667*^9, 3.441963327428399*^9}, {
   3.441963389505729*^9, 3.441963433145796*^9}, {3.4419635367382193`*^9, 
   3.4419635406444197`*^9}, 3.4419636689084024`*^9, {3.4419645763811617`*^9, 
   3.44196458164672*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vol Stochastique", "Subsection",
 CellChangeTimes->{{3.442576271096143*^9, 3.4425762778771324`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StochVolBSVol", "[", 
   RowBox[{
   "CC_", ",", "CCDev1_", ",", "CCDev2_", ",", "CCInvInteg_", ",", "\[Rho]_", 
    ",", "\[Nu]_", ",", "F_", ",", "K_", ",", "T_", ",", "fav_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w", ",", "H1", ",", "H2", ",", "Q", ",", "b1", ",", "b2", ",", "b3", 
      ",", "x", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b1", "=", 
      RowBox[{
       FractionBox["1", "24"], " ", 
       SuperscriptBox["\[Nu]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"CCDev1", "[", "fav", "]"}], " ", "\[Nu]", " ", "\[Rho]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "[", "fav", "]"}], ")"}], "2"], "24"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", 
           RowBox[{"CCDev2", "[", "fav", "]"}]}], 
          RowBox[{"CC", "[", "fav", "]"}]], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"CCDev1", "[", "fav", "]"}], 
            RowBox[{"CC", "[", "fav", "]"}]], ")"}], "2"], "+", 
         FractionBox["1", 
          SuperscriptBox["fav", "2"]]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CCInvInteg", "[", "F", "]"}], "-", 
        RowBox[{"CCInvInteg", "[", "K", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"F", "-", "K"}], "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"CC", "[", "F", "]"}], "]"}], " "}], "F"], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"Log", "[", 
           RowBox[{"F", "/", "K"}], "]"}], "x"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441963296725667*^9, 3.441963327428399*^9}, {
   3.441963389505729*^9, 3.441963433145796*^9}, {3.4419635367382193`*^9, 
   3.4419635406444197`*^9}, 3.4419636689084024`*^9, {3.4419644307111516`*^9, 
   3.441964435148595*^9}, {3.4419644828511095`*^9, 3.4419644895853977`*^9}, {
   3.441971445865712*^9, 3.4419714557236357`*^9}, {3.4420365651973877`*^9, 
   3.442036575498312*^9}, {3.4420506925084105`*^9, 3.442050693227147*^9}, {
   3.442050818349745*^9, 3.442050839958705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StochVolNormVol", "[", 
   RowBox[{
   "CC_", ",", "CCDev1_", ",", "CCDev2_", ",", "CCInvInteg_", ",", "\[Rho]_", 
    ",", "\[Nu]_", ",", "F_", ",", "K_", ",", "T_", ",", "fav_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w", ",", "H1", ",", "H2", ",", "Q", ",", "b1", ",", "b2", ",", "b3", 
      ",", "x", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b1", "=", 
      RowBox[{
       FractionBox["1", "24"], " ", 
       SuperscriptBox["\[Nu]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ";", 
     RowBox[{"b2", "=", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"CCDev1", "[", "fav", "]"}], " ", "\[Nu]", " ", "\[Rho]"}]}], 
     ";", 
     RowBox[{"b3", "=", 
      RowBox[{
       FractionBox["1", "24"], "  ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"CCDev2", "[", "fav", "]"}], 
          RowBox[{"CC", "[", "fav", "]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"CCDev1", "[", "fav", "]"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"CC", "[", "fav", "]"}], "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{
       RowBox[{"CCInvInteg", "[", "F", "]"}], "-", 
       RowBox[{"CCInvInteg", "[", "K", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"F", "-", "K"}], "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], ",", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"CC", "[", "F", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"K", "-", "F"}], "x"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4420337393372164`*^9, 3.4420337501960354`*^9}, 
   3.4420361516355753`*^9, {3.4420361860088153`*^9, 3.4420362870098147`*^9}, {
   3.442036383068281*^9, 3.4420364038266783`*^9}, {3.4420364589475813`*^9, 
   3.4420364901008325`*^9}, {3.442036533856278*^9, 3.442036546348888*^9}, {
   3.442050519324236*^9, 3.442050653306039*^9}, {3.442580840701913*^9, 
   3.442580908371189*^9}, {3.4425812387022543`*^9, 3.442581245842605*^9}, 
   3.4425812759351997`*^9, {3.442581675747971*^9, 3.4425816797946906`*^9}, {
   3.442581725589807*^9, 3.4425817401829967`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hagan SABR", "Section",
 CellChangeTimes->{{3.4425746214563665`*^9, 3.4425746247531147`*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"SABRHaganBSVol", "[", 
    RowBox[{
    "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "x", ",", "Effetmat"}], "}"}], ",", 
     RowBox[{
      RowBox[{"z", "=", 
       FractionBox[
        RowBox[{
         SuperscriptBox["f", 
          RowBox[{"1", "-", "\[Beta]"}]], "-", 
         SuperscriptBox["K", 
          RowBox[{"1", "-", "\[Beta]"}]]}], 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Rho]"}], "+", 
           RowBox[{"\[Nu]", " ", "z"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}]]}], 
          RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Effetmat", "=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "24"], " ", 
              SuperscriptBox["\[Alpha]", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Beta]"}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"f", " ", "K"}], ")"}], 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]"}]]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", "\[Alpha]", " ", "\[Beta]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"f", " ", "K"}], ")"}], 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}]}]], " ", 
              "\[Nu]", " ", "\[Rho]"}], "+", 
             RowBox[{
              FractionBox["1", "24"], " ", 
              SuperscriptBox["\[Nu]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}], " ", 
           "T"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "24"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Log", "[", 
             FractionBox["f", "K"], "]"}], "2"]}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Beta]"}], ")"}], "4"], " ", 
            SuperscriptBox[
             RowBox[{"Log", "[", 
              FractionBox["f", "K"], "]"}], "4"]}], "1920"]}], ")"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "0"}], ",", 
        RowBox[{
         SuperscriptBox["K", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]"}]], " ", "\[Alpha]", " ", 
         "Effetmat"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["\[Alpha]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"f", " ", "K"}], ")"}], 
           FractionBox[
            RowBox[{"1", "-", "\[Beta]"}], 
            RowBox[{"2", " "}]]]], " ", 
         FractionBox["z", "x"], "  ", "Effetmat"}]}], "  ", "]"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.388747033023386*^9, 3.3887470688834496`*^9}, {
   3.3887471345253344`*^9, 3.388747164025901*^9}, {3.388747342044944*^9, 
   3.3887473734986725`*^9}, {3.388747406030547*^9, 3.388747533298616*^9}, {
   3.388747587362154*^9, 3.3887476113313637`*^9}, {3.3887477318805532`*^9, 
   3.388747737052528*^9}, {3.3887478340075145`*^9, 3.3887478344918985`*^9}, 
   3.4425792927301073`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRHaganCallBSOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"BS", "[", 
   RowBox[{"F", ",", "K", ",", "T", ",", 
    RowBox[{"SABRHaganBSVol", "[", 
     RowBox[{
     "F", ",", "K", ",", "\[Alpha]", ",", "T", ",", "\[Beta]", ",", "\[Rho]", 
      ",", "\[Nu]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4425760457454214`*^9, 3.442576110289818*^9}, 
   3.4425792928082294`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRHaganCallBSDigitale", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2", ",", 
      RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"SABRHaganCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"SABRHaganCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s2", "-", "s1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "shift"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080461678854*^9, 3.4420805372297*^9}, {
   3.442080584495062*^9, 3.4420806618475657`*^9}, {3.44208105012672*^9, 
   3.442081057135847*^9}, {3.442125925826945*^9, 3.4421259259988165`*^9}, 
   3.442125958545067*^9, {3.442129320136773*^9, 3.4421293324802856`*^9}, {
   3.4421294416188154`*^9, 3.4421294449625015`*^9}, {3.4425750818449364`*^9, 
   3.442575085297929*^9}, {3.44257522901116*^9, 3.442575234010968*^9}, {
   3.442576161115991*^9, 3.4425762141920776`*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"SABRHaganNormVol", "[", 
    RowBox[{
    "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "z", ",", "x", ",", "Effetmat", ",", "b1", ",", "b2", ",", "b3", ",", 
       "fav"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "=", 
       FractionBox[
        RowBox[{
         SuperscriptBox["f", 
          RowBox[{"1", "-", "\[Beta]"}]], "-", 
         SuperscriptBox["K", 
          RowBox[{"1", "-", "\[Beta]"}]]}], 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}], ";", 
      RowBox[{"fav", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"f", "+", "K"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{
        FractionBox["1", "24"], " ", 
        SuperscriptBox["\[Nu]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[Alpha]", " ", "\[Beta]", " ", 
        SuperscriptBox["fav", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "1"}], ")"}]], " ", "\[Nu]", " ", 
        "\[Rho]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b3", "=", 
       RowBox[{
        FractionBox["1", "24"], " ", 
        SuperscriptBox["fav", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", "\[Beta]"}]}]], " ", 
        SuperscriptBox["\[Alpha]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "1"}], ")"}], "2"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Rho]"}], "+", 
           RowBox[{"\[Nu]", " ", "z"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}]]}], 
          RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"f", "-", "K"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[Alpha]", " ", 
           SuperscriptBox["f", "\[Beta]"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"T", " ", 
            RowBox[{"(", 
             RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          FractionBox[
           RowBox[{"K", "-", "f"}], "x"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"T", " ", 
            RowBox[{"(", 
             RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}]}], 
       "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.388747033023386*^9, 3.3887470688834496`*^9}, {
   3.3887471345253344`*^9, 3.388747164025901*^9}, {3.388747342044944*^9, 
   3.3887473734986725`*^9}, {3.388747406030547*^9, 3.388747533298616*^9}, {
   3.388747587362154*^9, 3.3887476113313637`*^9}, {3.3887477318805532`*^9, 
   3.388747737052528*^9}, {3.3887478340075145`*^9, 3.3887478344918985`*^9}, 
   3.4425792927301073`*^9, {3.442579408335043*^9, 3.4425794101318493`*^9}, {
   3.4425795426580095`*^9, 3.4425795753130054`*^9}, {3.4425797069642*^9, 
   3.4425797618683414`*^9}, {3.442579813631979*^9, 3.44257982858453*^9}, {
   3.4425800771218605`*^9, 3.442580098824152*^9}, {3.442580170602646*^9, 
   3.442580201742075*^9}, {3.442580435295606*^9, 3.442580435795587*^9}, {
   3.442580477278369*^9, 3.442580499355646*^9}, 3.442580748002348*^9, {
   3.442580822265121*^9, 3.442580830030448*^9}, {3.442580920933207*^9, 
   3.4425809388856425`*^9}, {3.4425811850480647`*^9, 3.442581221843527*^9}, {
   3.4425812875910015`*^9, 3.442581290840877*^9}, {3.442581610828589*^9, 
   3.442581624031207*^9}, 3.4425817134965215`*^9, {3.4425817735410905`*^9, 
   3.4425817774628153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRHaganCallNormOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"BS", "[", 
   RowBox[{"F", ",", "K", ",", "T", ",", 
    RowBox[{"SABRHaganNormVol", "[", 
     RowBox[{
     "F", ",", "K", ",", "\[Alpha]", ",", "T", ",", "\[Beta]", ",", "\[Rho]", 
      ",", "\[Nu]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4425760457454214`*^9, 3.442576110289818*^9}, 
   3.4425792928082294`*^9, {3.442579432052882*^9, 3.44257944955221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRHaganCallNormDigitale", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2", ",", 
      RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"SABRHaganCallNormOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"SABRHaganCallNormOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s2", "-", "s1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "shift"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080461678854*^9, 3.4420805372297*^9}, {
   3.442080584495062*^9, 3.4420806618475657`*^9}, {3.44208105012672*^9, 
   3.442081057135847*^9}, {3.442125925826945*^9, 3.4421259259988165`*^9}, 
   3.442125958545067*^9, {3.442129320136773*^9, 3.4421293324802856`*^9}, {
   3.4421294416188154`*^9, 3.4421294449625015`*^9}, {3.4425750818449364`*^9, 
   3.442575085297929*^9}, {3.44257522901116*^9, 3.442575234010968*^9}, {
   3.442576161115991*^9, 3.4425762141920776`*^9}, {3.4425794360839777`*^9, 
   3.442579444239914*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pure SABR", "Section",
 CellChangeTimes->{{3.4425746214563665`*^9, 3.4425746247531147`*^9}, {
  3.442575980966659*^9, 3.4425759835915585`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCC", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_"}], "]"}], ":=", 
  RowBox[{"alpha", " ", 
   SuperscriptBox["F", "beta"]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003246612156*^9, 3.4380032699712315`*^9}, {
   3.4380926319517713`*^9, 3.4380926423885365`*^9}, 3.442559734716757*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCCDev1", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_"}], "]"}], ":=", 
  RowBox[{"alpha", " ", "beta", " ", 
   SuperscriptBox["F", 
    RowBox[{"(", 
     RowBox[{"beta", "-", "1"}], ")"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380032882053733`*^9, 3.4380033350641484`*^9}, {
   3.438092649966128*^9, 3.438092661480942*^9}, 3.442559734732382*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCCDev2", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_"}], "]"}], ":=", 
  RowBox[{"alpha", "  ", "beta", " ", 
   RowBox[{"(", 
    RowBox[{"beta", "-", "1"}], ")"}], 
   SuperscriptBox["F", 
    RowBox[{"(", 
     RowBox[{"beta", "-", "2"}], ")"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003313751921*^9, 3.4380033394390926`*^9}, {
   3.438092653356514*^9, 3.438092664324492*^9}, 3.442559734732382*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCCInvInteg", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_"}], "]"}], ":=", 
  FractionBox[
   SuperscriptBox["F", 
    RowBox[{"(", 
     RowBox[{"1", "-", "beta"}], ")"}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "beta"}], ")"}], "alpha"}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003346189006*^9, 3.4380033795792036`*^9}, {
   3.4380039693431964`*^9, 3.4380039888577447`*^9}, {3.438092667871117*^9, 
   3.4380926806514673`*^9}, 3.442559734732382*^9}],

Cell[CellGroupData[{

Cell["Pricing", "Subsection",
 CellChangeTimes->{{3.4425743398734293`*^9, 3.442574341842104*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCallBSVol", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fav", "=", "F"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolBSVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCC", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCCDev1", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCCDev2", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCCInvInteg", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", "\[Rho]", ",", "\[Nu]", ",", "F", ",", "K", ",", "T", ",", "fav"}],
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380040200779047`*^9, 3.4380042000263567`*^9}, {
   3.4380926992439084`*^9, 3.438092721461094*^9}, {3.438324420054838*^9, 
   3.4383244214454184`*^9}, {3.4419684116758194`*^9, 3.4419684240194116`*^9}, 
   3.4419684694407053`*^9, {3.4419685262212286`*^9, 3.4419686249699645`*^9}, {
   3.4419687870772643`*^9, 3.4419687878897543`*^9}, {3.4419726512725706`*^9, 
   3.44197272399039*^9}, {3.4420419083645697`*^9, 3.4420419381608725`*^9}, {
   3.4420420194874363`*^9, 3.4420420431588564`*^9}, {3.4420421567035513`*^9, 
   3.4420421707189074`*^9}, {3.4420423017632666`*^9, 
   3.4420423133880434`*^9}, {3.442042618022819*^9, 3.4420426488816013`*^9}, {
   3.4420427532858467`*^9, 3.442042772019862*^9}, {3.442054596636575*^9, 
   3.4420546114175415`*^9}, {3.442054724321624*^9, 3.4420547350089183`*^9}, {
   3.442125789282692*^9, 3.442125790470169*^9}, {3.4425750634862666`*^9, 
   3.442575073657751*^9}, {3.4425751531078253`*^9, 3.4425751672322826`*^9}, {
   3.4425764309650035`*^9, 3.442576440089653*^9}, {3.4425788869175663`*^9, 
   3.442578892839214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCallBSOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"BS", "[", 
   RowBox[{"K", ",", "K", ",", "T", ",", 
    RowBox[{"SABRCallBSVol", "[", 
     RowBox[{
     "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
      "K", ",", "T"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080131930903*^9, 3.442080133160964*^9}, {
   3.442080171793741*^9, 3.442080172978009*^9}, 3.442080227556539*^9, {
   3.442080361116934*^9, 3.44208038935461*^9}, 3.4421258311568875`*^9, 
   3.442125925655073*^9, {3.4425750762982745`*^9, 3.4425750793762817`*^9}, {
   3.442575172607076*^9, 3.442575188372096*^9}, {3.4425764511204796`*^9, 
   3.4425764918845387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCallBSDigitale", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2", ",", 
      RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"SABRCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"SABRCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s2", "-", "s1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "shift"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080461678854*^9, 3.4420805372297*^9}, {
   3.442080584495062*^9, 3.4420806618475657`*^9}, {3.44208105012672*^9, 
   3.442081057135847*^9}, {3.442125925826945*^9, 3.4421259259988165`*^9}, 
   3.442125958545067*^9, {3.442129320136773*^9, 3.4421293324802856`*^9}, {
   3.4421294416188154`*^9, 3.4421294449625015`*^9}, {3.4425750818449364`*^9, 
   3.442575085297929*^9}, {3.44257522901116*^9, 3.442575234010968*^9}, {
   3.442576523836437*^9, 3.442576591349469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCallNormVol", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fav", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F", "+", "K"}], ")"}], "/", "2"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"StochVolNormVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCC", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCCDev1", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCCDev2", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SABRCCInvInteg", "[", 
         RowBox[{"#", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], ")"}], "&"}], 
      ",", "\[Rho]", ",", "\[Nu]", ",", "F", ",", "K", ",", "T", ",", "fav"}],
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441968448987842*^9, 3.441968515924485*^9}, {
   3.441968574861231*^9, 3.4419686345010924`*^9}, {3.4419687921397*^9, 
   3.4419687928428154`*^9}, {3.44197266774111*^9, 3.4419727349433746`*^9}, {
   3.4420368103404083`*^9, 3.442036814264944*^9}, 3.4420419115051346`*^9, {
   3.4420419425826626`*^9, 3.4420419499262714`*^9}, {3.4420420483618813`*^9, 
   3.4420420670021486`*^9}, {3.4420421743438377`*^9, 3.442042183281166*^9}, {
   3.442042316872351*^9, 3.442042324934696*^9}, {3.442054618417407*^9, 
   3.442054627729728*^9}, {3.4420547445556097`*^9, 3.442054751852345*^9}, 
   3.442125875937278*^9, {3.442575089125907*^9, 3.4425750994692597`*^9}, {
   3.4425751768881617`*^9, 3.442575207636981*^9}, 3.442576456573395*^9, {
   3.4425789058230906`*^9, 3.442578912182221*^9}, {3.442581095895238*^9, 
   3.4425811009887924`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRCallNormOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"NormalCall", "[", 
   RowBox[{"F", ",", 
    RowBox[{"SABRCallNormVol", "[", 
     RowBox[{
     "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
      "K", ",", "T"}], "]"}], ",", "K", ",", "T"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080163355235*^9, 3.442080164609918*^9}, {
   3.4420802896529703`*^9, 3.442080340954749*^9}, {3.4421258759529023`*^9, 
   3.442125904952346*^9}, {3.4425751016098022`*^9, 3.442575104219077*^9}, {
   3.4425751805442715`*^9, 3.4425751927938013`*^9}, 3.4425764612919636`*^9, 
   3.44257650175916*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SABRCallNormDigitale", "[", 
    RowBox[{
    "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1", ",", "s2", ",", 
       RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "=", 
       RowBox[{"SABRCallNormOption", "[", 
        RowBox[{
        "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"SABRCallNormOption", "[", 
        RowBox[{
        "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s2", "-", "s1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "shift"}], ")"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080716722554*^9, 3.442080796180972*^9}, {
   3.442081037512772*^9, 3.442081042446968*^9}, {3.442125905124217*^9, 
   3.442125905280464*^9}, 3.442125977482203*^9, {3.442129350979931*^9, 
   3.4421293611984844`*^9}, {3.4421294288378105`*^9, 3.442129431853378*^9}, {
   3.4425751064846153`*^9, 3.4425751113281794`*^9}, {3.4425752130898967`*^9, 
   3.4425752191052904`*^9}, 3.4425764714478235`*^9, {3.4425765422419806`*^9, 
   3.442576587474618*^9}, {3.442578571648423*^9, 3.44257858019497*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", "ATMvol", ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.45"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SABRCallBSVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}], ",", 
       RowBox[{"SABRHaganBSVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", "0.15"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.442578486792307*^9, 
   3.4425785310093584`*^9}, 3.4425792928238535`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV1nk8VPsbB/CunYpEe1FK1gpRKXxQVFKiJOl3E6GSIktyEal7teBWZLlt
sg5m5oz1HMY2M1LSWMpOQhSR5aKS6nfu67zO67ze/5zv8jzP9/mucblg5yYy
Z86cXvr97/v2f+b+PUGxqFvC+RCORtyM3KVifz0Wy7vLetMNG7Elz7LueUws
3gapE8LNjYiS2qdBpMZC7qV14Xr1RhjlHeoKFcZit/t1pa8LGpEo5WaxUiUO
unGhvav6GnA4769FDi/iMJZD6bncaECN1KuC2iXxuJQWvM+8qx5NOvlis8OJ
MJEfk4uQqcO7a6YvV959gESVNHNpQS2mlNk7pjQeo2KT2dG+whosWmncJfXj
CapaBrNMM59jk4l/q9z+p/gcmKd3ofsZ2h51tG+jUkA9SU4tkK+C1NrNuaVK
aRiUae297snHVuP/Wew4l45v/C33pmYrMR1X0N3elAFH1cy7C2MqkH/tnYGv
GgOZpRNVWUVl+DF5W+KxNgO/XhXtbmWVwdLNsKVGl4HfSjvzZNLL0GpxN1DF
iAGdL3r/C40tw6zErpKGgwx8Vyi5mOxTBosbGaY6QQwkHOxht2uXoTnq/L6R
WgZag98ztmeU4uv9WWePi1koarJyrs7hYkdFFSUamIVtqyo78lK5CB2MXvgk
JAvPHj6Nz3jAhbjRGkFrZBZazuz9lHqbi4U9FmpWj7NwysKU++UcFxu0Yka0
a7MwOrpEKLqJC5fyNUETqtmIIy9t7CNLkPZxqDFaKxuvOs1dBJwSfJTP19LS
zYaGjUoqM6sEF05ZdrkaZUPbVeZswoMSBEt7mjbZZWNQjZNSF1aC+EP5EuSV
bMw7UNL4wqoEtR8s74W0ZePzy7rbC/uL4eH0S0i9zcZHZ/nPHt3FEKkrkpnu
y8aS+8Z9grZiGBaqXz3/ORs2jOr7ccJipF+T8TkhmgPBuH/IXbIY4WuEB8w2
5EBPI254NqoYW5zsZcTDc5Btp/YrzaQYDcL5lmZ/5mCsfu+mfw2Lcc78WXjI
rRxc+VMPewyKkaKx9dtUXA4CgqREZbSLseDr0o8DWTlgLrDeOrysGEOxnVXP
3+RA47vVpNYXCo+FruG31Znobq5PTCyioP99m4XhRibOzcgpx+ZRqFGTlR7Y
zIQnc7I3nk1hOoz8G2Bi8m9v5ZIMCtab5z+ZsGdC/ZeBnncCha/xhWVHI5hQ
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
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
yjwTqYIkM8xg9WoBtvdpWVwRrcL/AVi4HLA=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.02, 0.1},
  PlotRange->{{0.02, 0.15}, {0.09669976189557422, 0.2851261866202294}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.4419687574838934`*^9, {3.441968840951575*^9, 3.4419688555920124`*^9}, 
   3.4419694585686693`*^9, 3.4419709809959793`*^9, 3.441971415557674*^9, 
   3.442032912332686*^9, {3.4420372962333755`*^9, 3.4420373245478687`*^9}, 
   3.4425735210767474`*^9, 3.442578547071242*^9, 3.4425789207131433`*^9, 
   3.442579308057644*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", "ATMvol", ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.45"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SABRCallNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}], ",", 
       RowBox[{"SABRHaganNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", "0.15"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.442578486792307*^9, 
   3.4425785310093584`*^9}, 3.4425792928238535`*^9, {3.4425803859225025`*^9, 
   3.442580393062853*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
YQ4nbI2xsQhedQp+L1JY+B+r+2mL
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJwV1Xk8VOsfB/CsIWRrk0t0haRQEckHZdpoUdFOpH43yqXOmbHvpTBaLOlW
CqUZM2cmjIhso+XaimwhS1Hpopskifqd+8d5ndf7j+c8z+t7Pt/vo+vp5+It
OWPGjBb6+e/dfciB6AtKRlfV7ACGRDQuxG3Q2xObjLea7b2uv6Jgkc94/iwp
Gc6pps+OTUchUW6rkTA7GaPzr0jEfo+CTf6u12ENyUjKm7Ok5HMU0uW8HbX0
UsAo6PBVfhOF3fnn5rj9nYJKp+3pLlVRqJGrF9XNS8Ohe21dhyKj0GJaID01
lI6qGutXOiOR6I2xq9W6fB3j+u3GBw9F4quOYO1Xowycd48etf07AnO01r2W
m74Frv6g7EG9CKywJdpnO2fiVrDdq3lS4Xh1s7NjTXEWLOVvqDffCIXc4pV5
j7TvQDbZ8USVVQgs1x1yXOt7F55f+wzKhoMwniLq6WjJQQ2x0cqXHYiCmN7V
pw04sNc6+1L/AAvTYwmyGcs4sGlJUBK4ssDwtmqrMeOg+LIz29qFhXbHyyw9
Gw4GnXqZezezMCW7oaRxBwcxCUVMoSULjudz7EyDOLinGZ/RosFCa+KprcN1
HKy4aui0oJEJnZ+aWguaOOiflDj6tY6J/516OrShjYMw56s+zc+YmNy2iH29
j4Pwkd0ef1Uwoa3S9GLrOAdWSvtCnYVMHL+82pWrw8WWhK7gjReZmEid8jge
wMXIy46ehy5MrK14XCzF4uLrmjQJwTYmwgbZardCuagI2RqQs4UJGRvd6vY4
LngvxYfvODCh1udosCWDi6vhlpat5kyYGCcNL6vjos/rZoSaBhOe5bpBo/q5
iNPaPHNpB4k7Hz42sY1zYbmoJK2wlcQH1QJjY7NcGCfJHdv0koTfUcZrL5tc
LH4w91VwHYkQeR+7FpdcyBTc69MrJ5G2q0C2KDwXo47Z95h3SNS9Z1wJfZUL
32/hET4kieMHfjUUd+fC45fqeOdpEpLPHyiMv81FR5eVaKc/CatCw6hTI7nQ
Hz2w2NmXxN0YBX93KR6cxXX2MZ4kInUbttmb8CBhPUF8205CK+XshVBzHkTU
9ZwyZxJFcnhSbMnDrybij/itJEY+CdaZO/Dwh2M6f/VGEgfLLi1b7MZDv/66
rHpbEhYH9ijIRPIQP83yU15BorFBiWF/loeMwB0epiYkfB2eRIbG82Am0bRg
rzGJLCPL719TePjx+fFokQEJlYn5H95xefgr2zehYhGJXJ/GxYuFPDQESKqr
6pBg9Jx3dxfR+034s47/RiL0yWRrWzkPQpFwUF+TxMfkrsfPmnmIykq/O6hO
IlYuRUKmgwenKk/vP9RILApxXmffw4NuYa/GJxUSbl5lBcWDPLgppTorKpOo
NruVxf3Jg/V2Eze2HImMBq/IBEM+znm6Lcj7SWDVjzWOVsv5WPc6WhA4TaDG
QFn+3Uo+FHuu7N80RWA8ougiwEfT3SVfJr8TcFqpdGt0Dx8BVuMOoq8E3ri/
8co4wIePd2OKaIwAM+GBgdMR+nvDZyUffSGQOXBEcMeXj+l185b2fSYwkVZY
tjeajw7JA8KwEQLs6vgomfN8OKluaXwwTGDxZw9GHpuP9f18hYkhAtu2zGqY
dY0PtRfrqxP/IdBP9l4qyuAjte2Tw9uPBAKzRHu87/BhUSDdBtrZU+6vy4R8
7PjhvFZ5kIC10erbPoV8eH2xlI/4QOD5HgXv+aV8mGqOv594T+BoVI/h40o+
iNolrSzak1TBkP9TPmYRO5p+vSNwsfO8ULue3u9hX0cibX059zO1TXzEXjMb
0aO944j81O/dfDS/+GLiOUDgXWJ3eeNbPkI2Z7gq0g5+mB8dNsjHgy/BUY/6
Cai8j9to/ImPI//4Cgjad9UPz2of42NOhm3nKto2diufx0zycX/6rtSPtwQa
feWumM2gcCbbcckz2sfSX7t2y1BoV862u0576nGeZvwsCv1PVu9g0r48eq7b
UpXC29S9LvtoG+gcyuyfS0FUsnuDA+3SrebHLmlRuDT/0GJz2i6smUtt9Sis
80kaMqT9Ibtr+KMBhdDIsetLaIc13r+fZkIBfhFmxrQ1fp4lNqykUPRYLceC
NmfpQavPaygsqyUnN9G2dTObvmFLoTbfy9CTdnO0bOWWDRRaOkJMomifEHbG
fNtMwWJ6pyyH9ozXwk3Z2ylInHEXtNJOlT+ruHMPhdV/KuvPouthbHHgxfR+
CvMtRV4M2hWepslcDwpPDqcdj6PtmiSz1+0YhZ+z3i1rpD1U0rFQ2peuz4oK
wSK6/pEfBD1CfwrpT8yHSNpz58RmHWJSoOZadb+kzbPff1whlILRv6WRlvT/
dDi1wvhBFIXpodSm27Tbrkl/8oqj4HyfXadG50NyjCIfXaGQ+SqTK0fnaclA
G2d7OoUj6gNy8bQ3t8543XeTwiJVXqU6nb+LRS7rZbkUCiMumq2h81nACSav
Cuj6+o30vKTdfi2bs1RE1zPFpY2g860TOj57ewWFfOV5SXVD/51HZ33fY3r9
v1sYkXR/HHPfRJ6upVCVtWyVDd0/lP21rrRWCnsL1W9Xf6LzI2vL6R2isO1E
2Boduv88vh3rChil8GYiTluG7s/oD0mzZSYoDMTaaXymXVPTRxhJCeAf7qHZ
OU5gX1KsQ8ACARiOtTO+TRIg59d3SjEEINd4X94sTeKa/Lhy6lYBXo7rTSfK
kHg0qe1guFMA9oXvuu2yJKRf/3nP6aAA8t1/RofKk7hyW4NICRDg0EiarOJs
EsKlB5UNMgT4mrJIauVCEs0LY+2LswV4EffF/YUWiW+K1JmtXAFyTDZpntYm
YfvpV4efSADdi8KkZ7ok6vOzcopqBSCaPFrzDOn5aPOP3ZYJAd4cbrsUbknC
myXlFjItwFzVkgPbrEj8+yrRwk1CCJuADyG6a+l5Peeu03lZIUrnBtxvpuf7
0YRW1rCKEBIs332nGCRcgiwbRfpCnLwb7HrClYSp6/dIxnYh0pve5HsG0vfF
aZnEnp1CuH7fP5AXTIJ3SfUqa7cQ79e3N8qGkTCoN6K4+4TwYomfFUeR0N6w
v0P5qBBW46qcrQkklMxLzNtYQvhtXKq28BZ9fqXQt8czhVitba61qYaEflya
udUdIQZOSFo61JPwkMyLVLgnxGBewUy7FyRax9/p8PlC5McyCxj0/VvVs+Pg
aJEQPs6Ft8LfkEi//3tLyHMhOsy4M/76QWLTnronl6aEcN/EGHcxZSLn+kJu
iet96DbsOlmQyYQXmdUw69d9FNrFm/19iYXjflXjvqI8fDe4qdUtCMTyyX3y
If/Lh9OAq9SPjiB8fd4ReG52AWIVCwPfTQVD+vHocFZ1AST1YpyXIRTqMmPl
pSdFGDJefUrNPwz9rSdDotULoWZi90XlVjimn4bZHHhaCFVDRmYEEYG50oH7
V/g9wMHSt88SVSLBdFcI0dAvgrSZtPV4UST+ctKIy2krwr4LF+J8DkehPGbm
qEVYMcbmqTzMn4iCcdcl9zbzh6jRzEtpy4hGapiM8ZnOh4hoWTA7Y20MqvM+
95ZFlCA03MtIsTkG1rLENc1VpZj4/j1aIzAWwuy++wGdpVguknIUqJ3FKc+B
us6Lj3DknMn76qKzWObT5GhvXYbI3lmL/XadA09mDWd3bxkyYaTM/XgOZ8pX
qQQml0PJJdAC7DhoeyZ+dNKugM2cDKvQJeexZKy2wTuwAiPDb779qjmP2c8Z
91qaKnBzY/0+Bd8LYG0vFK5fUonrj6eft0vEI9b9s/XDiErc8Aj62ZwVD7U5
umPLWyoReGPtw2zrBESqJ2ZOGlRBPdnvlWZDAt1f1U0NkVXQn3ZQyT2ZCP2W
f81ut1ShJ2TCw1iSDZZGT+C8tiq0XzW7WSnNRt2u+srE9iqER0g1u81k40wT
Z2dQZxU0lc4YxSiyUfXc039XXxW+ZFwN7prLxuGaZqHMcBVELacfxRuzkVpe
tOKEtBghLikl/bvZ+PjzLrNXRoy/ixWVgtzYWGebUu46UwyD1hVus/ez0V/q
v329ghj1CcEtVu5smD9c6qelIoZKvFUQ+w82GgquUw0LxZC91XzUIowNvbEL
4xt+EyM8bJt9bQQbxMpA2xJtMXhJoXM9otnQytvTkKMrRve9ae75ODZOCJRH
IgzE+OaWGtJ1mY2ykanV3wzFmHeiRts/hQ3V5f+EnlwqRt+pomKZq2wU8Z4q
7TcR442g+tXyG2woDon2vFguxpzf+g+LM9jwMM6+wTAVY7CrvMstk42CE5cH
Ss3E6D+3d9dQNhszuREmK1fS60VUVUQOG/8HuWFuIQ==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.02, 0.006},
  PlotRange->{{0.02, 0.15}, {0.005319858543526604, 0.014967924062001484`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.4419687574838934`*^9, {3.441968840951575*^9, 3.4419688555920124`*^9}, 
   3.4419694585686693`*^9, 3.4419709809959793`*^9, 3.441971415557674*^9, 
   3.442032912332686*^9, {3.4420372962333755`*^9, 3.4420373245478687`*^9}, 
   3.4425735210767474`*^9, 3.442578547071242*^9, 3.4425789207131433`*^9, 
   3.442579308057644*^9, 3.442580394781537*^9, {3.4425804429984355`*^9, 
   3.4425804449514856`*^9}, 3.4425805051054254`*^9, 3.4425807572519927`*^9, 
   3.4425811266128087`*^9, 3.44258179125916*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Epsilon SABR", "Section",
 CellChangeTimes->{{3.44257427787581*^9, 3.4425742811569343`*^9}}],

Cell[CellGroupData[{

Cell["Definition de la vol Loc", "Subsection",
 CellChangeTimes->{{3.442574320764788*^9, 3.442574326764558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ESABRCC", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"alpha", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", "+", "F"}], ")"}], "beta"]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003246612156*^9, 3.4380032699712315`*^9}, {
  3.4380926319517713`*^9, 3.4380926423885365`*^9}, {3.441972258216778*^9, 
  3.441972259623001*^9}, {3.441972442697611*^9, 3.4419724799468956`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ESABRCCDev1", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"alpha", " ", "beta", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", "+", "F"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"beta", "-", "1"}], ")"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380032882053733`*^9, 3.4380033350641484`*^9}, {
   3.438092649966128*^9, 3.438092661480942*^9}, 3.441972273669606*^9, {
   3.441972465072181*^9, 3.441972498571538*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ESABRCCDev2", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "beta_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"alpha", "  ", "beta", " ", 
   RowBox[{"(", 
    RowBox[{"beta", "-", "1"}], ")"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", "+", "F"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"beta", "-", "2"}], ")"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003313751921*^9, 3.4380033394390926`*^9}, {
   3.438092653356514*^9, 3.438092664324492*^9}, 3.441972276482052*^9, {
   3.441972467384637*^9, 3.441972502321466*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ESABRCCInvInteg", "[", 
   RowBox[{"F_", ",", "alpha_", ",", "\[Beta]_", ",", "\[Epsilon]_"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"F", " ", 
     SuperscriptBox["\[Epsilon]", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}]], " ", 
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox["\[Beta]", "2"], ",", 
       FractionBox["3", "2"], ",", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["F", "2"], "\[Epsilon]"]}]}], "]"}]}], ")"}], "/", 
   "alpha"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003346189006*^9, 3.4380033795792036`*^9}, {
   3.4380039693431964`*^9, 3.4380039888577447`*^9}, {3.438092667871117*^9, 
   3.4380926806514673`*^9}, 3.4419722797476144`*^9, {3.441972469853339*^9, 
   3.4419724751032386`*^9}, {3.4419725164618196`*^9, 3.4419725831640673`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pricing", "Subsection",
 CellChangeTimes->{{3.4425743398734293`*^9, 3.442574341842104*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ESABRCallBSVol", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "vol_", ",", "T_", ",", "beta_", ",", "\[Rho]_", ",",
     "\[Nu]_", ",", "\[Epsilon]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolBSVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCC", "[", 
         RowBox[{"#", ",", "vol", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCCDev1", "[", 
         RowBox[{"#", ",", "vol", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCCDev2", "[", 
         RowBox[{"#", ",", "vol", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCCInvInteg", "[", 
         RowBox[{"#", ",", "vol", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", "\[Rho]", ",", "\[Nu]", ",", "F", ",", "K", ",", 
      "T"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380040200779047`*^9, 3.4380042000263567`*^9}, {
   3.4380926992439084`*^9, 3.438092721461094*^9}, {3.438324420054838*^9, 
   3.4383244214454184`*^9}, {3.4419684116758194`*^9, 3.4419684240194116`*^9}, 
   3.4419684694407053`*^9, {3.4419685262212286`*^9, 3.4419686249699645`*^9}, {
   3.4419687870772643`*^9, 3.4419687878897543`*^9}, {3.4419726512725706`*^9, 
   3.44197272399039*^9}, 3.4421277034021893`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ESABRCallNormVol", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "alpha_", ",", "T_", ",", "beta_", ",", "\[Rho]_", 
    ",", "\[Nu]_", ",", "\[Epsilon]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolNormVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCC", "[", 
         RowBox[{"#", ",", "alpha", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCCDev1", "[", 
         RowBox[{"#", ",", "alpha", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCCDev2", "[", 
         RowBox[{"#", ",", "alpha", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ESABRCCInvInteg", "[", 
         RowBox[{"#", ",", "alpha", ",", "beta", ",", "\[Epsilon]"}], "]"}], 
        ")"}], "&"}], ",", "\[Rho]", ",", "\[Nu]", ",", "F", ",", "K", ",", 
      "T", ",", "F"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441968448987842*^9, 3.441968515924485*^9}, {
   3.441968574861231*^9, 3.4419686345010924`*^9}, {3.4419687921397*^9, 
   3.4419687928428154`*^9}, {3.44197266774111*^9, 3.4419727349433746`*^9}, {
   3.4420368103404083`*^9, 3.442036814264944*^9}, 3.442127654278133*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Epsilon gamma SABR", "Section",
 CellChangeTimes->{{3.442574193769665*^9, 3.4425742015506163`*^9}}],

Cell[CellGroupData[{

Cell["Definition de la vol Loc", "Subsection",
 CellChangeTimes->{{3.442574320764788*^9, 3.442574326764558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCC", "[", 
   RowBox[{
   "F_", ",", "F0_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Epsilon]_", 
    ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"Sech", "[", 
    FractionBox[
     RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"F0", "+", 
            RowBox[{"\[Gamma]", " ", 
             RowBox[{"Sinh", "[", 
              FractionBox[
               RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"], 
         "\[Epsilon]"]}], ")"}]}], ")"}], 
    RowBox[{"\[Beta]", "/", "2"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442040831900863*^9, 3.4420408638221254`*^9}, 
   3.4420419671446915`*^9, {3.4420422108900113`*^9, 3.442042219686717*^9}, {
   3.4420535886246796`*^9, 3.4420535897496576`*^9}, 3.4420545012477818`*^9, 
   3.442059019114162*^9, 3.4420600374852343`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCCDev1", "[", 
   RowBox[{
   "F_", ",", "F0_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Epsilon]_", 
    ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"F0", "+", 
            RowBox[{"\[Gamma]", " ", 
             RowBox[{"Sinh", "[", 
              FractionBox[
               RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"], 
         "\[Epsilon]"]}], ")"}]}], ")"}], 
    RowBox[{"\[Beta]", "/", "2"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{"F0", "+", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"Sinh", "[", 
           FractionBox[
            RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}]}], 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"F0", "+", 
             RowBox[{"\[Gamma]", " ", 
              RowBox[{"Sinh", "[", 
               FractionBox[
                RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"],
           "\[Epsilon]"]}], ")"}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"Sech", "[", 
        FractionBox[
         RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}], "\[Gamma]"]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442041688806285*^9, 3.4420416945874243`*^9}, 
   3.442041755273759*^9, 3.442041974019559*^9, {3.442042228124055*^9, 
   3.4420422579047337`*^9}, {3.4420535643595204`*^9, 3.4420535754374323`*^9}, 
   3.442054463420383*^9, 3.4420590373638115`*^9, 3.4420600463913126`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCCDev2", "[", 
   RowBox[{
   "F_", ",", "F0_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Epsilon]_", 
    ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"F0", "+", 
            RowBox[{"\[Gamma]", " ", 
             RowBox[{"Sinh", "[", 
              FractionBox[
               RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"], 
         "\[Epsilon]"]}], ")"}]}], ")"}], 
    RowBox[{"\[Beta]", "/", "2"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sech", "[", 
         FractionBox[
          RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}], "3"], 
       SuperscriptBox["\[Gamma]", "2"]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Beta]"}], ")"}], " ", "\[Beta]", " ", 
       RowBox[{"Cosh", "[", 
        FractionBox[
         RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"F0", "+", 
          RowBox[{"\[Gamma]", " ", 
           RowBox[{"Sinh", "[", 
            FractionBox[
             RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"F0", "+", 
              RowBox[{"\[Gamma]", " ", 
               RowBox[{"Sinh", "[", 
                FractionBox[
                 RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], 
            "2"], "\[Epsilon]"]}], ")"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{"\[Beta]", " ", 
       RowBox[{"Cosh", "[", 
        FractionBox[
         RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}], 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"F0", "+", 
             RowBox[{"\[Gamma]", " ", 
              RowBox[{"Sinh", "[", 
               FractionBox[
                RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"],
           "\[Epsilon]"]}], ")"}]}]], "-", 
     FractionBox[
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{"F0", "+", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"Sinh", "[", 
           FractionBox[
            RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}], 
      RowBox[{"\[Gamma]", " ", "\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"F0", "+", 
             RowBox[{"\[Gamma]", " ", 
              RowBox[{"Sinh", "[", 
               FractionBox[
                RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"],
           "\[Epsilon]"]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Sech", "[", 
        FractionBox[
         RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}], "2"]}], 
      SuperscriptBox["\[Gamma]", "2"]]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442041773773404*^9, 3.442041776710848*^9}, 
   3.4420419823631487`*^9, {3.4420422355145383`*^9, 3.4420422611702957`*^9}, {
   3.4420535941401987`*^9, 3.442053596046412*^9}, {3.4420544759357677`*^9, 
   3.4420544827793865`*^9}, 3.4420590514416666`*^9, 3.442060060187923*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCCInvInteg", "[", 
   RowBox[{
   "F_", ",", "F0_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Epsilon]_", 
    ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "\[Alpha]"], "  ", 
   SuperscriptBox["\[Epsilon]", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], "/", "2"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox["\[Beta]", "2"], ",", 
       FractionBox["3", "2"], ",", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"F0", "+", 
            RowBox[{"\[Gamma]", " ", 
             RowBox[{"Sinh", "[", 
              FractionBox[
               RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}], "2"], 
         "\[Epsilon]"]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"F0", "+", 
       RowBox[{"\[Gamma]", " ", 
        RowBox[{"Sinh", "[", 
         FractionBox[
          RowBox[{"F", "-", "F0"}], "\[Gamma]"], "]"}]}]}], ")"}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4420416081047096`*^9, 3.4420416353073125`*^9}, 
   3.442041988800525*^9, {3.442042265123345*^9, 3.4420422739513006`*^9}, {
   3.4420536005150757`*^9, 3.442053601874425*^9}, {3.442054545684428*^9, 
   3.4420545760588455`*^9}, {3.442059091831516*^9, 3.4420591110811462`*^9}, {
   3.4420600818593817`*^9, 3.442060095452871*^9}, {3.442060130702194*^9, 
   3.4420601409988713`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pricing", "Subsection",
 CellChangeTimes->{{3.4425743398734293`*^9, 3.442574341842104*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCallBSVol", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "\[Epsilon]_", ",", "\[Gamma]_", ",", "K_", ",", "T_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fav", "=", "F"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolBSVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCC", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCCDev1", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCCDev2", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCCInvInteg", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", "\[Rho]", ",", "\[Nu]",
       ",", "F", ",", "K", ",", "T", ",", "fav"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380040200779047`*^9, 3.4380042000263567`*^9}, {
   3.4380926992439084`*^9, 3.438092721461094*^9}, {3.438324420054838*^9, 
   3.4383244214454184`*^9}, {3.4419684116758194`*^9, 3.4419684240194116`*^9}, 
   3.4419684694407053`*^9, {3.4419685262212286`*^9, 3.4419686249699645`*^9}, {
   3.4419687870772643`*^9, 3.4419687878897543`*^9}, {3.4419726512725706`*^9, 
   3.44197272399039*^9}, {3.4420419083645697`*^9, 3.4420419381608725`*^9}, {
   3.4420420194874363`*^9, 3.4420420431588564`*^9}, {3.4420421567035513`*^9, 
   3.4420421707189074`*^9}, {3.4420423017632666`*^9, 
   3.4420423133880434`*^9}, {3.442042618022819*^9, 3.4420426488816013`*^9}, {
   3.4420427532858467`*^9, 3.442042772019862*^9}, {3.442054596636575*^9, 
   3.4420546114175415`*^9}, {3.442054724321624*^9, 3.4420547350089183`*^9}, {
   3.442125789282692*^9, 3.442125790470169*^9}, {3.4425766597218437`*^9, 
   3.442576674971258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCallBSOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "\[Epsilon]_", ",", "\[Gamma]_", ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"BS", "[", 
   RowBox[{"K", ",", "K", ",", "T", ",", 
    RowBox[{"EZSABRCallBSVol", "[", 
     RowBox[{
     "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
      "\[Epsilon]", ",", "\[Gamma]", ",", "K", ",", "T"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080131930903*^9, 3.442080133160964*^9}, {
   3.442080171793741*^9, 3.442080172978009*^9}, 3.442080227556539*^9, {
   3.442080361116934*^9, 3.44208038935461*^9}, 3.4421258311568875`*^9, 
   3.442125925655073*^9, 3.442576696095447*^9, {3.44257678104531*^9, 
   3.4425767967009583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCallBSDigitale", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "\[Epsilon]_", ",", "\[Gamma]_", ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2", ",", 
      RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"EZSABRCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",",
         "\[Epsilon]", ",", "\[Gamma]", ",", 
        RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"EZSABRCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",",
         "\[Epsilon]", ",", "\[Gamma]", ",", 
        RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s2", "-", "s1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "shift"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080461678854*^9, 3.4420805372297*^9}, {
   3.442080584495062*^9, 3.4420806618475657`*^9}, {3.44208105012672*^9, 
   3.442081057135847*^9}, {3.442125925826945*^9, 3.4421259259988165`*^9}, 
   3.442125958545067*^9, {3.442129320136773*^9, 3.4421293324802856`*^9}, {
   3.4421294416188154`*^9, 3.4421294449625015`*^9}, 3.4425767006108985`*^9, {
   3.4425768065287066`*^9, 3.44257683299644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCallNormVol", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "\[Epsilon]_", ",", "\[Gamma]_", ",", "K_", ",", "T_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fav", "=", "F"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolNormVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCC", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCCDev1", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCCDev2", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EZSABRCCInvInteg", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Epsilon]", 
          ",", "\[Gamma]"}], "]"}], ")"}], "&"}], ",", "\[Rho]", ",", "\[Nu]",
       ",", "F", ",", "K", ",", "T", ",", "fav"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441968448987842*^9, 3.441968515924485*^9}, {
   3.441968574861231*^9, 3.4419686345010924`*^9}, {3.4419687921397*^9, 
   3.4419687928428154`*^9}, {3.44197266774111*^9, 3.4419727349433746`*^9}, {
   3.4420368103404083`*^9, 3.442036814264944*^9}, 3.4420419115051346`*^9, {
   3.4420419425826626`*^9, 3.4420419499262714`*^9}, {3.4420420483618813`*^9, 
   3.4420420670021486`*^9}, {3.4420421743438377`*^9, 3.442042183281166*^9}, {
   3.442042316872351*^9, 3.442042324934696*^9}, {3.442054618417407*^9, 
   3.442054627729728*^9}, {3.4420547445556097`*^9, 3.442054751852345*^9}, 
   3.442125875937278*^9, 3.4425767047513647`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EZSABRCallNormOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "\[Epsilon]_", ",", "\[Gamma]_", ",", "K_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"NormalCall", "[", 
   RowBox[{"F", ",", 
    RowBox[{"EZSABRCallNormVol", "[", 
     RowBox[{
     "F", ",", "K", ",", "\[Alpha]", ",", "T", ",", "\[Beta]", ",", "\[Rho]", 
      ",", "\[Nu]", ",", "\[Epsilon]", ",", "\[Gamma]"}], "]"}], ",", "K", 
    ",", "T"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080163355235*^9, 3.442080164609918*^9}, {
   3.4420802896529703`*^9, 3.442080340954749*^9}, {3.4421258759529023`*^9, 
   3.442125904952346*^9}, 3.4425767099386654`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EZSABRCallNormDigitale", "[", 
    RowBox[{
    "F_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "\[Epsilon]_", ",", "\[Gamma]_", ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1", ",", "s2", ",", 
       RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "=", 
       RowBox[{"EZSABRCallNormOption", "[", 
        RowBox[{
        "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "\[Epsilon]", ",", "\[Gamma]", ",", 
         RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"EZSABRCallNormOption", "[", 
        RowBox[{
        "F", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "\[Epsilon]", ",", "\[Gamma]", ",", 
         RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s2", "-", "s1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "shift"}], ")"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080716722554*^9, 3.442080796180972*^9}, {
   3.442081037512772*^9, 3.442081042446968*^9}, {3.442125905124217*^9, 
   3.442125905280464*^9}, 3.442125977482203*^9, {3.442129350979931*^9, 
   3.4421293611984844`*^9}, {3.4421294288378105`*^9, 3.442129431853378*^9}, 
   3.442576714297873*^9, {3.442576852761306*^9, 3.442576878666561*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", "ATMvol", ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.45"}], ",", 
     RowBox[{"\[Epsilon]", "=", "0.0001"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.15"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EZSABRCallBSVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "\[Epsilon]", ",", "\[Gamma]", ",", "K", ",", "T"}], "]"}], ",", 
       RowBox[{"SABRHaganBSVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", "0.15"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.442578486792307*^9, 
   3.4425785310093584`*^9}, 3.4425792928238535`*^9, {3.4425803859225025`*^9, 
   3.442580393062853*^9}, {3.4425819854860764`*^9, 3.4425820263126335`*^9}, {
   3.4425820703109446`*^9, 3.44258207679507*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
6K1bxwedN4dRHCXA/wEq9kSY
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
yjwTqYIkM8xg9WoBtvdpWVwRrcL/AVi4HLA=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.02, 0.1},
  PlotRange->{{0.02, 0.15}, {0.09686265778393045, 0.28780039094398197`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.4419687574838934`*^9, {3.441968840951575*^9, 3.4419688555920124`*^9}, 
   3.4419694585686693`*^9, 3.4419709809959793`*^9, 3.441971415557674*^9, 
   3.442032912332686*^9, {3.4420372962333755`*^9, 3.4420373245478687`*^9}, 
   3.4425735210767474`*^9, 3.442578547071242*^9, 3.4425789207131433`*^9, 
   3.442579308057644*^9, 3.442580394781537*^9, {3.4425804429984355`*^9, 
   3.4425804449514856`*^9}, 3.4425805051054254`*^9, 3.4425807572519927`*^9, 
   3.4425811266128087`*^9, 3.44258179125916*^9, 3.442582031546808*^9, 
   3.442582079123106*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", "ATMvol", ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.45"}], ",", 
     RowBox[{"\[Epsilon]", "=", "0.0001"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.08"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EZSABRCallNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "\[Epsilon]", ",", "\[Gamma]", ",", "K", ",", "T"}], "]"}], ",", 
       RowBox[{"SABRHaganNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", "0.15"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.442578486792307*^9, 
   3.4425785310093584`*^9}, 3.4425792928238535`*^9, {3.4425803859225025`*^9, 
   3.442580393062853*^9}, {3.4425819854860764`*^9, 3.4425820263126335`*^9}, {
   3.442582094013159*^9, 3.4425821123093314`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.02, 0.006},
  PlotRange->{{0.02, 0.15}, {0.0053320842986145645`, 0.014967924062001484`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.4419687574838934`*^9, {3.441968840951575*^9, 3.4419688555920124`*^9}, 
   3.4419694585686693`*^9, 3.4419709809959793`*^9, 3.441971415557674*^9, 
   3.442032912332686*^9, {3.4420372962333755`*^9, 3.4420373245478687`*^9}, 
   3.4425735210767474`*^9, 3.442578547071242*^9, 3.4425789207131433`*^9, 
   3.442579308057644*^9, 3.442580394781537*^9, {3.4425804429984355`*^9, 
   3.4425804449514856`*^9}, 3.4425805051054254`*^9, 3.4425807572519927`*^9, 
   3.4425811266128087`*^9, 3.44258179125916*^9, 3.442582031546808*^9, {
   3.442582095763092*^9, 3.442582113340542*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", "ATMvol", ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.45"}], ",", 
     RowBox[{"\[Epsilon]", "=", "0.0002"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.08"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EZSABRCallNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "\[Epsilon]", ",", "\[Gamma]", ",", "K", ",", "T"}], "]"}], ",", 
       RowBox[{"SABRHaganNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", 
       RowBox[{"-", "0.02"}], ",", "0.15"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.442578486792307*^9, 
   3.4425785310093584`*^9}, 3.4425792928238535`*^9, {3.4425803859225025`*^9, 
   3.442580393062853*^9}, {3.4425819854860764`*^9, 3.4425820263126335`*^9}, {
   3.442582094013159*^9, 3.4425821123093314`*^9}, {3.442582276443653*^9, 
   3.4425823003802342`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
BHrGxiLkPCtMMDzMxP8A+ygMyw==
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
Gfdzu1coFNFh0c9V0dQk53dmceNK6PgfiJd0Hg==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0.006},
  PlotRange->{{-0.02, 0.15}, {0.005343585242535251, 0.014967923971975742`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.4419687574838934`*^9, {3.441968840951575*^9, 3.4419688555920124`*^9}, 
   3.4419694585686693`*^9, 3.4419709809959793`*^9, 3.441971415557674*^9, 
   3.442032912332686*^9, {3.4420372962333755`*^9, 3.4420373245478687`*^9}, 
   3.4425735210767474`*^9, 3.442578547071242*^9, 3.4425789207131433`*^9, 
   3.442579308057644*^9, 3.442580394781537*^9, {3.4425804429984355`*^9, 
   3.4425804449514856`*^9}, 3.4425805051054254`*^9, 3.4425807572519927`*^9, 
   3.4425811266128087`*^9, 3.44258179125916*^9, 3.442582031546808*^9, {
   3.442582095763092*^9, 3.442582113340542*^9}, {3.4425822773811173`*^9, 
   3.442582301130205*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Paribas SABR", "Section",
 CellChangeTimes->{{3.4425744719777317`*^9, 3.442574475352602*^9}}],

Cell[CellGroupData[{

Cell["Definition de la vol Loc", "Subsection",
 CellChangeTimes->{{3.442574320764788*^9, 3.442574326764558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCC", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",",
     "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["F", 
           RowBox[{"\[Beta]1", "-", "\[Beta]2"}]], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[Lambda]", " ", "F"}]], "-", "1"}], ")"}]}]}]], ")"}], 
      SuperscriptBox["F", "\[Beta]1"]}], "+", 
     RowBox[{
      SuperscriptBox["F", "\[Beta]2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox["1", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["F", 
            RowBox[{"\[Beta]1", "-", "\[Beta]2"}]], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[Lambda]", " ", "F"}]], "-", "1"}], ")"}]}]}]]}], 
       ")"}]}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003246612156*^9, 3.4380032699712315`*^9}, {
   3.4380926319517713`*^9, 3.4380926423885365`*^9}, {3.442145878814139*^9, 
   3.442145879439127*^9}, {3.4421459230789137`*^9, 3.4421459445941257`*^9}, 
   3.4421460365767345`*^9, {3.442146106247272*^9, 3.4421461081691103`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCCDev1", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",",
     "\[Lambda]_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"F", " ", "\[Lambda]"}]], " ", 
    SuperscriptBox["F", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Beta]1", "+", "\[Beta]2"}]], " ", 
    "\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["F", "\[Beta]2"], " ", "\[Beta]1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
       SuperscriptBox["F", "\[Beta]1"], " ", "\[Beta]2"}], "-", 
      RowBox[{
       SuperscriptBox["F", 
        RowBox[{"1", "+", "\[Beta]1"}]], " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["F", 
        RowBox[{"1", "+", "\[Beta]2"}]], " ", "\[Lambda]"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
       SuperscriptBox["F", "\[Beta]1"]}], "+", 
      SuperscriptBox["F", "\[Beta]2"]}], ")"}], "2"]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380032882053733`*^9, 3.4380033350641484`*^9}, {
   3.438092649966128*^9, 3.438092661480942*^9}, {3.442145880954723*^9, 
   3.44214588187658*^9}, {3.4421459281100674`*^9, 3.442145953672076*^9}, 
   3.442146032436189*^9, 3.4421461648555217`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCCDev2", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",",
     "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
        SuperscriptBox["F", "\[Beta]1"]}], "+", 
       SuperscriptBox["F", "\[Beta]2"]}], ")"}], "3"]], 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"F", " ", "\[Lambda]"}]], " ", 
   SuperscriptBox["F", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "\[Beta]1", "+", "\[Beta]2"}]], " ", "\[Alpha]",
    " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["F", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Beta]1"}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], "2"], " ", 
      SuperscriptBox["F", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Beta]2"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
      SuperscriptBox["F", 
       RowBox[{"\[Beta]1", "+", "\[Beta]2"}]], " ", 
      RowBox[{"(", 
       RowBox[{"\[Beta]1", "+", 
        SuperscriptBox["\[Beta]1", "2"], "+", "\[Beta]2", "-", 
        RowBox[{"4", " ", "\[Beta]1", " ", "\[Beta]2"}], "+", 
        SuperscriptBox["\[Beta]2", "2"]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["F", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]2"}]}]], " ", "\[Beta]1", " ", 
      "\[Lambda]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
      SuperscriptBox["F", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Beta]1"}]}]], " ", "\[Beta]2", " ", 
      "\[Lambda]"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F", 
       RowBox[{"1", "+", "\[Beta]1", "+", "\[Beta]2"}]], " ", 
      RowBox[{"(", 
       RowBox[{"\[Beta]1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"F", " ", "\[Lambda]"}]], " ", "\[Beta]1"}], "+", 
        "\[Beta]2", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"F", " ", "\[Lambda]"}]], " ", "\[Beta]2"}]}], ")"}], " ", 
      "\[Lambda]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
      SuperscriptBox["F", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
      SuperscriptBox["\[Lambda]", "2"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"F", " ", "\[Lambda]"}]]}], ")"}], " ", 
      SuperscriptBox["F", 
       RowBox[{"2", "+", "\[Beta]1", "+", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Lambda]", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", "\[Beta]2"}]}]], " ", 
      SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003313751921*^9, 3.4380033394390926`*^9}, {
   3.438092653356514*^9, 3.438092664324492*^9}, {3.442145883423425*^9, 
   3.442145884329658*^9}, {3.4421459320474916`*^9, 3.4421459574063797`*^9}, 
   3.442146030592475*^9, 3.4421461896362963`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCCInvInteg", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",",
     "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "\[Alpha]"], 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["F", 
          RowBox[{"1", "-", "\[Beta]2"}]], "-", 
         SuperscriptBox["K", 
          RowBox[{"1", "-", "\[Beta]2"}]]}], ")"}], " "}], 
      RowBox[{"1", "-", "\[Beta]2"}]], "+", 
     RowBox[{
      SuperscriptBox["\[Lambda]", 
       RowBox[{"\[Beta]1", "-", "1"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Gamma", "[", 
          RowBox[{
           RowBox[{"1", "-", "\[Beta]1"}], ",", 
           RowBox[{"F", " ", "\[Lambda]"}]}], "]"}]}], "+", 
        RowBox[{"Gamma", "[", 
         RowBox[{
          RowBox[{"1", "-", "\[Beta]1"}], ",", 
          RowBox[{"K", " ", "\[Lambda]"}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[Lambda]", 
       RowBox[{"\[Beta]2", "-", "1"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{
          RowBox[{"1", "-", "\[Beta]2"}], ",", 
          RowBox[{"F", " ", "\[Lambda]"}]}], "]"}], "-", 
        RowBox[{"Gamma", "[", 
         RowBox[{
          RowBox[{"1", "-", "\[Beta]2"}], ",", 
          RowBox[{"K", " ", "\[Lambda]"}]}], "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438003346189006*^9, 3.4380033795792036`*^9}, {
  3.4380039693431964`*^9, 3.4380039888577447`*^9}, {3.438092667871117*^9, 
  3.4380926806514673`*^9}, {3.442145886876484*^9, 3.442145887907714*^9}, {
  3.44214593629741*^9, 3.442145960953187*^9}, {3.4421460022961426`*^9, 
  3.442146020155175*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pricing", "Subsection",
 CellChangeTimes->{{3.4425743398734293`*^9, 3.442574341842104*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCallBSVol", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", 
    "\[Lambda]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", "K_", ",", "T_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fav", "=", "F"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolBSVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCC", "[", 
         RowBox[{
         "F", ",", "#", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCCDev1", "[", 
         RowBox[{
         "F", ",", "#", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCCDev2", "[", 
         RowBox[{
         "F", ",", "#", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCCInvInteg", "[", 
         RowBox[{
         "F", ",", "#", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", "\[Rho]", ",", 
      "\[Nu]", ",", "F", ",", "K", ",", "T", ",", "fav"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380040200779047`*^9, 3.4380042000263567`*^9}, {
   3.4380926992439084`*^9, 3.438092721461094*^9}, {3.438324420054838*^9, 
   3.4383244214454184`*^9}, {3.4419684116758194`*^9, 3.4419684240194116`*^9}, 
   3.4419684694407053`*^9, {3.4419685262212286`*^9, 3.4419686249699645`*^9}, {
   3.4419687870772643`*^9, 3.4419687878897543`*^9}, {3.4419726512725706`*^9, 
   3.44197272399039*^9}, {3.4420419083645697`*^9, 3.4420419381608725`*^9}, {
   3.4420420194874363`*^9, 3.4420420431588564`*^9}, {3.4420421567035513`*^9, 
   3.4420421707189074`*^9}, {3.4420423017632666`*^9, 
   3.4420423133880434`*^9}, {3.442042618022819*^9, 3.4420426488816013`*^9}, {
   3.4420427532858467`*^9, 3.442042772019862*^9}, {3.442054596636575*^9, 
   3.4420546114175415`*^9}, {3.442054724321624*^9, 3.4420547350089183`*^9}, {
   3.442125789282692*^9, 3.442125790470169*^9}, {3.442146298368583*^9, 
   3.442146321102522*^9}, {3.442146423163062*^9, 3.4421464385221424`*^9}, {
   3.442146503067778*^9, 3.44214651727063*^9}, {3.4421465599573107`*^9, 
   3.442146577535098*^9}, {3.4421499366581016`*^9, 3.44214997737607*^9}, 
   3.4421500203596196`*^9, {3.442579022927968*^9, 3.4425790317713785`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCallBSOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", 
    "\[Lambda]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", "K_", ",", "T_"}], 
   "]"}], ":=", 
  RowBox[{"BS", "[", 
   RowBox[{"K", ",", "K", ",", "T", ",", 
    RowBox[{"PSABRCallBSVol", "[", 
     RowBox[{
     "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", "\[Lambda]",
       ",", "\[Rho]", ",", "\[Nu]", ",", "K", ",", "T"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080131930903*^9, 3.442080133160964*^9}, {
   3.442080171793741*^9, 3.442080172978009*^9}, 3.442080227556539*^9, {
   3.442080361116934*^9, 3.44208038935461*^9}, 3.4421258311568875`*^9, 
   3.442125925655073*^9, {3.4421463265867915`*^9, 3.442146330774211*^9}, {
   3.4421464431158037`*^9, 3.442146447428221*^9}, 3.4421465277548037`*^9, 
   3.442146583816228*^9, 3.4425790456614704`*^9, 3.4425790981125813`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCallBSDigitale", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", 
    "\[Lambda]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", "K_", ",", "T_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2", ",", 
      RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"PSABRCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", 
        "\[Lambda]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"PSABRCallBSOption", "[", 
       RowBox[{
       "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", 
        "\[Lambda]", ",", "\[Rho]", ",", "\[Nu]", ",", 
        RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s2", "-", "s1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "shift"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080461678854*^9, 3.4420805372297*^9}, {
   3.442080584495062*^9, 3.4420806618475657`*^9}, {3.44208105012672*^9, 
   3.442081057135847*^9}, {3.442125925826945*^9, 3.4421259259988165`*^9}, 
   3.442125958545067*^9, {3.442129320136773*^9, 3.4421293324802856`*^9}, {
   3.4421294416188154`*^9, 3.4421294449625015`*^9}, {3.442146335196001*^9, 
   3.4421463420864935`*^9}, {3.4421464513812704`*^9, 3.4421464598498573`*^9}, 
   3.442146533723439*^9, {3.442146587550531*^9, 3.442146590487974*^9}, 
   3.4425790573797703`*^9, {3.4425791207835855`*^9, 3.442579173125325*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCallNormVol", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", 
    "\[Lambda]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", "K_", ",", "T_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fav", "=", "F"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StochVolNormVol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCC", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCCDev1", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCCDev2", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PSABRCCInvInteg", "[", 
         RowBox[{
         "#", ",", "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", 
          ",", "\[Lambda]"}], "]"}], ")"}], "&"}], ",", "\[Rho]", ",", 
      "\[Nu]", ",", "F", ",", "K", ",", "T", ",", "fav"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441968448987842*^9, 3.441968515924485*^9}, {
   3.441968574861231*^9, 3.4419686345010924`*^9}, {3.4419687921397*^9, 
   3.4419687928428154`*^9}, {3.44197266774111*^9, 3.4419727349433746`*^9}, {
   3.4420368103404083`*^9, 3.442036814264944*^9}, 3.4420419115051346`*^9, {
   3.4420419425826626`*^9, 3.4420419499262714`*^9}, {3.4420420483618813`*^9, 
   3.4420420670021486`*^9}, {3.4420421743438377`*^9, 3.442042183281166*^9}, {
   3.442042316872351*^9, 3.442042324934696*^9}, {3.442054618417407*^9, 
   3.442054627729728*^9}, {3.4420547445556097`*^9, 3.442054751852345*^9}, 
   3.442125875937278*^9, {3.4421463453364315`*^9, 3.442146357601821*^9}, {
   3.442146462427933*^9, 3.4421464767245336`*^9}, 3.442146536895253*^9, {
   3.4421465959566193`*^9, 3.442146607815767*^9}, 3.4425790495363216`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PSABRCallNormOption", "[", 
   RowBox[{
   "F_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", 
    "\[Lambda]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", "K_", ",", "T_"}], 
   "]"}], ":=", 
  RowBox[{"NormalCall", "[", 
   RowBox[{"F", ",", 
    RowBox[{"PSABRCallNormVol", "[", 
     RowBox[{
     "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", "\[Lambda]",
       ",", "\[Rho]", ",", "\[Nu]", ",", "K", ",", "T"}], "]"}], ",", "K", 
    ",", "T"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080163355235*^9, 3.442080164609918*^9}, {
   3.4420802896529703`*^9, 3.442080340954749*^9}, {3.4421258759529023`*^9, 
   3.442125904952346*^9}, {3.442146375679599*^9, 3.4421463826950893`*^9}, {
   3.442146480021345*^9, 3.4421464852243705`*^9}, 3.4421465408170533`*^9, 
   3.4421466132531624`*^9, {3.442579067988738*^9, 3.442579086519276*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PSABRCallNormDigitale", "[", 
    RowBox[{
    "F_", ",", "\[Alpha]_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", 
     "\[Lambda]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", "K_", ",", "T_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1", ",", "s2", ",", 
       RowBox[{"shift", "=", "0.00001"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "=", 
       RowBox[{"PSABRCallNormOption", "[", 
        RowBox[{
        "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", 
         "\[Lambda]", ",", "\[Rho]", ",", "\[Nu]", ",", 
         RowBox[{"K", "+", "shift"}], ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"PSABRCallNormOption", "[", 
        RowBox[{
        "F", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", 
         "\[Lambda]", ",", "\[Rho]", ",", "\[Nu]", ",", 
         RowBox[{"K", "-", "shift"}], ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s2", "-", "s1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "shift"}], ")"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442080716722554*^9, 3.442080796180972*^9}, {
   3.442081037512772*^9, 3.442081042446968*^9}, {3.442125905124217*^9, 
   3.442125905280464*^9}, 3.442125977482203*^9, {3.442129350979931*^9, 
   3.4421293611984844`*^9}, {3.4421294288378105`*^9, 3.442129431853378*^9}, {
   3.4421463864293923`*^9, 3.4421463923042793`*^9}, {3.442146488286812*^9, 
   3.4421464942398224`*^9}, 3.4421465444888573`*^9, {3.4421466177374516`*^9, 
   3.442146621596752*^9}, 3.4425790721917014`*^9, {3.4425791273458333`*^9, 
   3.44257917001607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.5"}], ",", 
     RowBox[{"\[Lambda]", "=", "100"}], ",", "ATMvol", ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.45"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PSABRCallBSVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", 
         "\[Lambda]", ",", "\[Rho]", ",", "\[Nu]", ",", "K", ",", "T"}], 
        "]"}], ",", 
       RowBox[{"SABRHaganBSVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", "0.15"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLegend", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<PSABR\>\"", ",", "\"\<Hagan\>\""}], "}"}]}], ",", 
     RowBox[{"LegendPosition", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.", ",", 
        RowBox[{"-", "0.5"}]}], "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.4419729631435785`*^9, 
   3.4419729959869084`*^9}, {3.4419742419865847`*^9, 3.4419742451740437`*^9}, 
   3.4421277034803133`*^9, {3.4421497032407084`*^9, 3.442149783348545*^9}, 
   3.442150054937081*^9, {3.442150144404113*^9, 3.4421501514196033`*^9}, 
   3.4421502055748134`*^9, {3.4421503571656528`*^9, 3.442150374930937*^9}, {
   3.442150530740445*^9, 3.4421505740052395`*^9}, {3.442579194437007*^9, 
   3.4425792023117046`*^9}, 3.4425792928238535`*^9}],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
DfGcCN0VK4QQOoVbCuJo/A/yZeg7
        "]]}, 
      {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
yjwTqYIkM8xg9WoBtvdpWVwRrcL/AVi4HLA=
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesOrigin->{0.02, 0.1},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotRange->{{0.02, 0.15}, {0.09686265778393045, 0.28289827608944323`}},
     PlotRangeClipping->True,
     PlotRangePadding->{
       Scaled[0.02], 
       Scaled[0.02]}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{1.05, -0.55}, {1.85, 0.050000000000000086`}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{RectangleBox[{1., -0.5}, {1.8, 0.10000000000000009`}],
         InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[
               {Hue[0.9060679774997897, 0.6, 0.6], 
                LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"Hagan\"\>", {1.2100000000000002`, 0.58}, {-1, 0}, 
              Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[
               {Hue[0.67, 0.6, 0.6], 
                LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"PSABR\"\>", {1.2100000000000002`, 1.74}, {-1, 0}, 
              Automatic, {1, 0}]}}, {}},
          AspectRatio->0.7500000000000001,
          FormatType->TraditionalForm,
          PlotRange->{{-0.1, 3.26}, {-0.1, 2.42}}], {1., -0.5}, {
         Left, Bottom}, {0.8, 0.6000000000000001}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{
  3.4419687574838934`*^9, {3.441968840951575*^9, 3.4419688555920124`*^9}, 
   3.4419694585686693`*^9, 3.4419709809959793`*^9, 3.441971415557674*^9, {
   3.4419729883151317`*^9, 3.4419729968618975`*^9}, {3.44197424311157*^9, 
   3.4419742461427813`*^9}, 3.4419746567312756`*^9, 3.4420332268165836`*^9, 
   3.442078548522043*^9, 3.4421467066888685`*^9, 3.4421497861453667`*^9, {
   3.442150030546924*^9, 3.4421500562964296`*^9}, {3.442150145732212*^9, 
   3.442150152138339*^9}, 3.442150206371673*^9, 3.442150388930668*^9, {
   3.4421505364434605`*^9, 3.4421505756614575`*^9}, 3.442573509233452*^9, 
   3.442579209702046*^9, 3.4425793148386335`*^9, 3.442582170994578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "=", "0.05"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.0248"}], ",", 
     RowBox[{"T", "=", "10"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.5"}], ",", 
     RowBox[{"\[Lambda]", "=", "100"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.56"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PSABRCallNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]1", ",", "\[Beta]2", ",", 
         "\[Lambda]", ",", "\[Rho]", ",", "\[Nu]", ",", "K", ",", "T"}], 
        "]"}], ",", 
       RowBox[{"SABRCallNormVol", "[", 
        RowBox[{
        "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "K", ",", "T"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", 
       RowBox[{"-", "0.1"}], ",", "0.15"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLegend", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<PSABR\>\"", ",", "\"\<Hagan\>\""}], "}"}]}], ",", 
     RowBox[{"LegendPosition", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.", ",", 
        RowBox[{"-", "0.5"}]}], "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4323744938870907`*^9, 3.432374521512621*^9}, {
   3.432374553013226*^9, 3.43237461077996*^9}, {3.44006397153573*^9, 
   3.440063972308663*^9}, {3.4400641631742477`*^9, 3.440064237173365*^9}, {
   3.4400643012875347`*^9, 3.440064330094763*^9}, {3.440064362942278*^9, 
   3.440064366108304*^9}, {3.441968811342579*^9, 3.441968853451415*^9}, {
   3.441969457943677*^9, 3.441969458099925*^9}, {3.4419718430914135`*^9, 
   3.441971885588693*^9}, {3.4419730305645905`*^9, 3.4419730915638103`*^9}, {
   3.4419741904559937`*^9, 3.441974213096329*^9}, 3.4419742926578107`*^9, {
   3.441974358656966*^9, 3.441974381484799*^9}, 3.4419744157968597`*^9, {
   3.4419748073387227`*^9, 3.441974868228568*^9}, {3.4419749314465094`*^9, 
   3.44197494075889*^9}, 3.442033213348523*^9, {3.442033417853677*^9, 
   3.4420334538987064`*^9}, {3.4420334973496065`*^9, 
   3.4420335132862906`*^9}, {3.442033594797742*^9, 3.4420335957039456`*^9}, {
   3.442036315094705*^9, 3.4420363201825476`*^9}, {3.442036869505519*^9, 
   3.4420368743525553`*^9}, {3.4420371002216883`*^9, 
   3.4420371061761847`*^9}, {3.442037493278004*^9, 3.4420375544194117`*^9}, {
   3.4420377535938363`*^9, 3.442037761625189*^9}, {3.442127654278133*^9, 
   3.442127654278133*^9}, {3.442150265761158*^9, 3.442150301541721*^9}, {
   3.4421503478533316`*^9, 3.4421503494626756`*^9}, 3.442150386040098*^9, {
   3.4421504989129314`*^9, 3.442150518662552*^9}, {3.4425793370721545`*^9, 
   3.4425793578057337`*^9}}],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
        "]]}, 
      {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJwVl3dcje8bx5MvCQ0hoyGVSNoqQpeiEC2roaWpoUVPe3dO8xynIUpFndk4
p53SuJsIpYkGoYQWTUrye35/ndf79frc1/3cn+tzX+d59tp5XnTk5uLiql3D
xfX/35cC9E3ES3lIal/jK2NNB/QxK89H3ygP+UcFlmpomKL7n6lP3E/noSGO
6ges5TQY7c/mvnM0D31V1MnUd7WD9e739UsU8tDg8rvJCrGbUF+cnNwjlYfO
9M1HDf7xAWwhcWBhZx762NyFfajAQEEzRnInfx7inyHe4/8SANudfsLc2jy0
KyXnl1VgMKwkmVt1LLGQzHjDU4vGUBitawrM+8FCT5J/P62wD4eX3+XuR39h
IWpp6Nro8xFQuv1uhc0gC/HVKWdqiUZChvZqt2YXCzWsgu+x/kiIuOn8c/sz
FvLJ9+VSJkTBjfROvplaFvqvjipkIRkNRq1H5V6VstBrjT4PSmk0qM/knmWy
WKhTsfOJrQYBxMQ2O0Vms1Be9qWyXaUE+O+cb5RVKgsNhnKPvZUiwsTtD4+O
xLPQjEfqGzKJCN2PztRvDWehu2ohqoI/iZDze9dSmxsLCaz2cyvnxkCsdJQw
/ToLuUYb9/yejQEv40nVcFMWmivemfhZKxa0WPUe6qfw/TV879a2xcK+3v2J
W46yUFl7eKQtbxxs5krKm1RgoUpXyTKKbhwMmNqP5u5mIfHwSbus8jhojHq1
JlQQr0f3uTL1NQ5YRWp7zNez0AbN77ylO+PBj2eDhcAsE92MEOk6eyserFW9
/ca/MpGTuWPujax40LMZSG19z0RDCtuT0lvjYdvjwtdBbUx0X1ZkhCmYAH8+
b5+6ipjI/9E8tUY1AT7zh21UqWCiBwcq6gyuJECJk4nut0dMtH1QLOlUagLc
T35i15zGRHmfraI6ShIgvF4qPDuRiU6mUUgyHQlgKLz45LI/E206/CAhZG0i
qOnYvFP0YKLXYcSEdNFEEPV4vrDRgYkuhjMnaw8nwnhrhlKjERMZi3mUnrNL
hBhfYMjvZyLmAyOenLJE8MhhNW8QY6KxK3YHpZ8mwtX2LZ9GhJhIgZo7uPI2
EaT3jYpkrDJQ56LMw5dLibDJxOCo7zwDnZ034nnNS4LZ4MqrxuMMlD1zvkpn
FwkaemOT1r9hIEq4aG2SOgmYXLOcTy8Z6Hbn8SK/0yQgH7r2qraRgQ656qiP
mJDAKlqe5xabgaRNbphYuZFgWbU7eDiagaL39nmbpJNg9ItP8VQgAxXejb5J
p5Kg/d7W0T9eDFSqa1aewybBoz+Xz++0YqCoD+seZzeQIJ69ECpziYGqtmR8
p7WR4LZNWunhcww0uz/azLqbBGea3+4yUWMgebJu8vxnEij5+hvYyDFQrGzk
dN84CXbv3xVxcy8DCT6rKLw1S4LpeItvcXwMVHy+0X2SiwypF99XNn2hI9s0
aX0eETKE/hc63jlIR1fekPO59pLhRqW4+HAXHV1+Ps5pkSHDsd22hD91dLTy
TiGyVJkM0q+4qnnL6Ujh2EGxYXUy8IfmTO7Ip6PoYykLg8fI8PnT50uH0+ho
XDfZ5bwuGV6lRMXoJNJREjXwZsM5MlToStcYR9JRvEZ0+EZDMsTmOUre9KCj
Mt80RcmrZFD0/vaTrkdHHeb2ksEOZNgpFSddfpyOsmMIFpXOZODukzVrUqEj
Gw1nz3ZXMrw54oY+iNPRmW96oXe9yNAwvmluchsdZRVm8J+9RYa8zEKZPxvp
aAvPN9aALxmCuaZJO37RUMqt2s+5gWRwKiU37puiIUdr16/9wWQwdlBcUB2h
oW+OvQ1zoWTQFO48oNNPQ/FWgttmwskg9dzL0vg1DcnbKkR0R5Jhc+AWinUr
DWnLuFLvR5NhUa602b2Ghlq2WWw5TSTDiztzB+OYNMTdEL7NII4M5dqp1vey
aOhUsWpjQTwZsuYOJ9NTaMj1yMi3mQQyEOl9rWVxNET2ceSTIJHByxRbagyj
oagNQ4XqZDJY8O6Q7/SloVbLN9rqd8hwuuax7Qc3GtI/4nNqD4UMCjfNUiev
05CmYNC+WZx37Fl6tmxKQx0LMWZFSWTg6kr/s8GQhvZp79Q3TSbDeKSm4o7T
NGTKU+QwjnPv4UG7fZo0NOw6JeCSQob6saA0VSUaiu0tKO7BmXVf9IW2DA09
khTKO5hKhiT9ur9GojQkPMgx88A5cMVK2VqIhrzcSaIPcXbgrDq4b6Ahl7jz
RnU4L0rdUMr9S0Wb270D2nCOTe/683aWirJ5c7MacN4tcOwZ3zcq8l2bKEPF
mR1NSz71nor4hGeCvHE+ucxnHdBNRR5a9dyHcO729JMtekZFLfz7xP7/fA5f
Ps6P1lLRjvSyg844L1roN+wupaIYK7fYb/j5YjvLEoyZVHTn7FvK/8+/W0/M
lJhJRfGvJDLLcX8Ka4iStUlU5LlXmosLZ1D+OTVDpKI1FVGCmrif3Qzz6v3B
VLS274m4Pe6/g2hztJU3FX3KVAwMwvsTy5Mm0naNikROO18ISsTrh/wbWzWm
IjkhaTN7vL+FszdKD+tR0fdM5cFjeP+73h8790iJipbLDaxQDF7vEn3bm31U
1LUsM+KK52fxOf/HTSK4/tCaaR4CXq/8E+a3jooMw1rIO/D8Fcqe12Ev56Li
hYXseDyfWg/L+UZ+5CLz9Z0HfuL5tY+PoRkO5KIXjonklCBcbyvfva8oF4n0
3M/Uvo3r36RlXaPlotlQl1BDHzJ0nudySUrPRZJiJ6KM8Pu0oN7zbyUqF7Ul
YOUK7rieL0C+1ywXPZaRLnGyx/XVLbGR3LmosWhd/ycjMtgpKlyu+pWDXn+M
09I1IMM87d6e6ckclPxc4MpDfTLsorhWmr/NQWf07UWP4PPBzklwVKkwBxUM
BOX8O4rrhSxh+EoOkl4W/84lSYZKz8Mf28/noAu6rz5t3UMGv1ebI2q1c5BM
8BNTCVEyLBPqmtLlc1Dxp3ebZITJsGZJXO/yuhzU/NWmYowXn0/Dny60lT9C
Q3bF3AY/SXCgwNmibOsjpHZB21W8mgRPiGPj/NQshO4Ii+WewOf7swOWx0hZ
KOvSqRKloySw3+DW7uyXhVRtlK/VHCbB5vgfRQ3ns9CtH5XCrXIksCb9vu0z
n4k+lkQpF+D/H9ypG//16Waiqg770rb5RNDPUdia9S0DSQ3RC2JYidBfgx2T
U7iPJCP6rTCeRFCdbWN2dyejUIesM89K4iEkfO+9NmYCyq/lG3hmGQfyrT5M
Qlc4YjuledLexcAqw3NKIC8c9QURjw11x0BHrLtqRng4UszqVNraHgMeF5wQ
RzEcfQoMSA9tjAEbZhmnSCQM9Z/d4H0+PwYcWiL4L6cGowzfh7S6IFy/KtaR
SfBDNFIg8IjHAH/TDouSw35o6OwV0X07Y6CIsGWsdQRDgjZZSjpCMfBz87rV
aW0MKSXNcgWuj4FbIpPy2qu30d0TY/ofp4ngf+QJ6Qvmg7jocd0xiAj/fSnM
sOx0RdetxBZP2xLhNeOQ4j8JV+Ry8KrvC3MiZNwobM7xdkHV2zduN7pEBKXJ
gskxoRvoat2Rx1f0iHBtLl/L+4ojWrJ4ccfsEBHs115s3VRhgyQ81rw9/JsA
v4km08ZXrVF2QnlU4QwByBtNdqT9skQTobVXpCYI8GSLsYuEpgWK+zHkyv+B
AIIShnxq6DLa849uO9BMAAbVQD3Q9hIKnr0A5+sIcHy/gQ1acxGd6b+oW1NJ
gA7L+3YpsYYo+u3N5/fzCBAckJpfm3wKyb7VLzl3hwCs8JQVvb6TyDvCoqss
Fq8nsC8rV/E4GmxP3S0WSYAVMSntx+XqSG5CgUQIIsClQ3u/vDyqjMx3WslO
3SbAZV8tocaQ/SiEfvHHJQ8CcEv7lvcK7EKj89rD1c4E+DbuKqW593v9QpDl
kvh1Apx1yZAjPhOCugOfb/myCLC4o6s93VwarB618f97SoBzf3oJXkaKkOCc
7W45RABDz8lsqqQaiM/Y/1adIsAv2+llcpYmkD1pAup/CGAs6y93YvNJOPJw
6pgmDxH2SQb0l7bpgOpNS6/6LURY3h0YcyBGFw4+dxjcKkKEjq1Batmnz4Jj
fouPD/4+nLs5eGQr93lYt3PtE245IvitC0mKQwZw3L1WekSZCDL/6h+GaRmD
SmqintwRIlCCEKaZZQKi6b+6pk7g9X8hg4U/F+Hkge1fj54iguPtBulii8vw
/jn/L5GzRNC82di9b6cpPKqamGkzJgLte2PeR8wMyqRWxRmXicDv1BT+oM8c
rsdetDlqhufvc5Pp1cPXQNLUxCjuGhFGrJsVtqRYQvv2+XcZ1kQwHGxe92rG
CrZn2Zj4XCdClWnLENHYBjq3YpStDkTQY9nprq6/DmqWCvUNN4hwmehqcLDs
OmyGNu02VyLYOfhcuWpjB1pPHV6z3IngpRNoFbnJHnScBO9c9yBCiESkI+ex
PWBFef4LnkSIX427OWDvACXv7pg7eRPh/lCS73pBR6i4Ed5f4UMExpP0EJVa
Rxj1aQr9cosI5fdzCNY3nABs60sWbxOhCcsjxW9zhhrP3Q3jvkTovFxyt7LB
GQ4keg43YUT4oFKd9dn9BriGMxTD/YgwKdhI59/lArpVG+uk/HF/p5+zNVtd
wO22WCQH5w3tnRVO3q5AjVBx2RtABOGCd3XJYm7wb90HgxCcpeI+tta3uYFG
w9HVJpyVnL+1j/u6A1GY5/gczlq6P/uEJW/CSnhpHX8gES5I/X6v03ETxOSP
KwrjbLGGa8wj0AOqDvCqbsT5xjDPdIaMJ/R+e2g3ga/H6gQWn3Z7Qn3mRaMn
ODe1bwoLAC9Ice6P9MO5rVYg6s5dL5C/9CFMCufOgq0x9AkvuJ4U3FSPP/+b
jB0JNdrecPRmecM5nN/HidzpuucN9yT6xlvw84/670n5OuUNO7LeFyjhPOEs
de/vKR8oU+tzIeF+zV7d/2Brhg/0L4sSB3E/udQUqaB3C448yTxngPvNI63K
vJJ5C7idBrO98X7wb9UocJu9BQVFM5xYvF+iM1pl97Jvg8m75sMUL9yvjzqP
2fO3YeG75okIvN8HX+vVNOv7whDVXMYJz4MG27D5x6Iv2B7UyNmM50Ur8+Kz
dQYYjGtvLu7A83Q64epLESoGIY2/0wkuRLjoYt1zxsgPbHtiP3Y7EcFjn8fI
Q6Y/bFXtmv+Jz0/fbT5fK/76w4UyG5aNDRGC12ITLy8FgMkMu63FCs/bp5C5
X/8CQPfWj38+Fni+skhrjc2C4MVztXR7fL6+386W4uINhYVFj9xy/L7deHk0
2Mg8FMRnq6eRNhHmw5/2ZueFwo0FleYWIMLmyWHCCf0wmKKmWtQcI4L4dd7b
dbrhoD66McxalQgGGsffLBMjoFOzdi5xLxEKRnIyfHmjIVl/YPr3EgG8tL7p
ZSlHwzTVse7qLwKopyvMtZhHA2PPqTXF8wRoMqw5vy0/GuZcbbde+UGAgere
lVJ9AkDupjDXUQLwUnhsfibgvha1vHjRTgDn4zel3PjjQMT6WuWDLALEx1K8
5o/GwYG3J3rUMgjA6S2rC3GMA9oPVvvLNALMuy+bUmrjoJaiEDiBz+vIrJjE
Ctd4YGTfil6OIED2as7Cv6cJcL4vlWzlSIA3DW+epYaRgTfmYpK9LAGokhLq
Nr+TYP56k3QiMxpsBYSlxPnugZVZN3XPvSgYWT47b7IhE3zvVISrukcCHy/p
59DjR5AhIYNKeSPg9fNjCddOUMG5+86hJsMwcMuuVp3/TYeJqLveexWDoV5A
OrxoLQNSw//EvJYMBqEI8itXfpyXMmJDhYPhib294ycpBrT/1rg//DcINsry
3eswZICYyJJy8asgyC+zXWbRGLC3iRiT7RoE4895Gq2MmXBB8JirNSsQtDR9
+HZdYwKl3eeuaWYgJBcMmfc6MmFytHX8MiUQNMkls/pBTDAOXcyw9A+E+EvX
pI8wmBB2ifGZejYQDn7gxAitMMHk6bfbKuMB4DJ3xfAZkwVinlN3fFQCgBxi
0tpWwoLxZqVzq/sDoJTH4PirGhb8lVrUTxYLgBWR0we7XrPAwJP+pmcDrj+t
sn7wF77ea3CmcdgfSu/y10+fyQPljFNrbt3xhxWNZ/LC3/IAWzr8LPaXH0g0
NdF2zuaBgLHSg6BpP9C9UC8ispIHdPmQ3SFf/IBsW8ErIZgPAU9PrWX34Po4
6hfZI/nQ+Z/b2NNiXD8QlnUiNh8OTKJpYQ8/cHUI2nYyOR+4i67uF3TC109j
CTqZ+eB5V69ZxNoP3nF7BJwpzodo2d3Cboa4Xs7yism7fFCKnav6qYjrg4/w
OR4oAKdOxS8vFzHYeMptElQLYI/4pq++PzAg8ma/3K1VAOHDC8NHv2EQmrY2
vvNSARz9xugSHMDAo7hj/fGwAohO2XGSG+FzAFszJhxfAE9DhuKjqjBwOnG4
dSa1AGK4Ho5LlGJg/SI9iplfALetL40W0zEwHHXg2vqmAO71fTY7RMbgRf69
4amPBcAn8XgiNRYDPe8X9c8nCmDt+zlnkSgMtFYVQ0LXFIJGD3ki0h8DhZ1/
lr4fKoQjbjT3RgcM8j/I97doFMLX4PRccVsMZOi2VQ91CmHyjMnhB9cwEFd5
il0xKwTpsFDuuYsY8F9ImmuIKgRP5U7uvacwiBdq6X5ALgSumOKhYMBgff9i
CZZeCM4v2fxLxzBYdbT0OlRUCF3O63ouqmEQeOiOEc+TQshnqSYqqWCwONuo
8LmlEHKSJSYUFDGYDts/dW+gEDK0ejpJshi46lm88vlSCHVCuTenZTAY20wq
MPhZCIv2J4c8pTGw60HxB/4UQivmJikkicGH9FmXtevZUPOr5VTfHgwsbPed
+yDIBh+XXu1qMQzeyJgdqBZhwzlZXtF6EQw6yurGPJTZIHZLw+zgTgz0A3+2
njvOBpZKCSdJGIOnJ6Xo0mfYIFpo9mLXdgx0eK5G/zNhw1D51UdNWzGob4+1
H7BkQ/XXHqlEIQw0U2t0KpzZoByyqottwaDSYnovxYcNnTmCi+GCGKjs3bvG
LYQNIbqmewsFMOB8vfRRN5YNm64fLfvFj8FBDhFJpLChLB/u2uPMuF2d/SeL
DT8rRYt+8GEgeWwy5A2LDZ9DK8Ye4Jy9Zo9VSRkbjM8clLiB8+7nJscT6/H9
RoZPXMY5jRwt4tzGhlzDOAlbnIWuPF7W7mWDU5IyMwFnksh4v+gwG0R+6xa9
wXlgmT2i9Z0NoV+9NhzF95cZ8J6ynWNDW1/xvUqcb1Wr/Yr8y4bBr3onjPDn
b7i/xEXn4UDaS/N33Pj5NvvXbXy2hQOpj//qdeFsbhqx7bsIB1wIx52e4H4w
1HXFN8lw4MmImFA97tfsdt4D8kocEM8s2jeE+6m18ErZSJMD2d/5grbhfif0
Uo55n+aAzZDbhBPej3dll3VTDDmw45mIUc8ODKRTdhpVmHGAXHYvxHwXBl4+
Q2Zv7ThgORBnsLQbgzqTR3ZL7hzo392XWiqKwVXBA9iJCA5oOhu/95LAIPfH
RJhNAr5fEJvoi+fnR0dRXMRdvF54x69kPF+xJI2s1jwO3NlWHbgDz2Of+x/G
1zIOyDu3KIbK4f24gIp56zngHrB/bkUeg5qNZ1oMujlwim/ki7YqBhvGN3Z4
DnGg90haOY86BpfbOt4mjXHgwl/HztEjeN5jrk70LXOgJ6RHdlQLA4l1TkLW
UkUw3D06MXMeA/dRWdFw+SL4flOT426EQXXz1L5cjSLg3u4q9xe/jxcjfY+O
nS8CSa1LcdYWGET/i7b1uF0E/v9lqYi5YvB9icoJbS0CUriBuBUJA/V+56pH
r4vA5hjFUyQZg8gquaam/iKwVc3XnUzDQNSvrG/9dBFEmM1XtDzCYH/g9dAz
m4pBYXaL7PkKvJ+/vOivVYvBx9JKLeoTfr+lNPY8O1IM0yt80mpfMaAZ/71f
f6IYkjnvfi5M4ufLi0tknykG3RsPMOpvfD/L3FsJ14rho5FqZJ6gH+Q39mif
iSoG2UCCyolTfrCSoP6hvrsY3u6RivMp8YOcqhXTyrfF+Puk0+3SKj/Q+9LU
xR4qBh7WpP8K8gOKllFr5lgxpDy4b8Dp8APpGefCwOVi+K9Gu4ow6QcGV9MD
1SVL4GS8q/F3WX/IllgR5niXwJXFl3ua8/3Bc+J9yxa/EpDmM8xuLvOHk5XI
xze4BGbfm294VesPn85HdRyPKQGS5KrifIc/SPttJL7MLAGTD/z92XP+kN++
c+HbsxIomIoSP6MVAJWBaj1S4qXQ/OGLg/a7AHjd63En/UUpfAy4u6dmdxBs
o/5n4bq5HLKu/XMeTg0BvZUIubMuFcDoHy/eoBAOCZ6SRpuKKkFLm0c2IDQC
IiW7C9ymH0N1UsGwQ1skONq6CPSfrQa1HWuPv1eMBssqqVa5xCcQmuKecDCE
ACcftEYkjNeAnYtBOmGUCH11mF+sTh3wa/8b0zkVC6HL+sg1qh60dWGUGBsH
W5vW81sMI3ixlrdE/Gs8vO/yMd2R3ACnd3+H8EOJEP/Z5bSxciO4Tf18Xu1C
AnZVb7nAh0YIkjuXtorIMCBi0qEd1gQ6/j5dzL93oLKzKmVLZBMY3l937t4a
CiQTJMw/RTfBoRnvdIv/KHDux4+R8PgmWBCq3PiJlwJVTeQldLcJvlsfV5za
RoE0l1fSWoVN0JLWFMktR4GLj88EafY3Qd5wmfNeUwoouBed3DjUBMkH47s+
m1Ng494d6wc+NMH25kE5miUFGuPHKAGjTdCrslIiY0cBJWsCo+pHE9hdifhP
7iYF+Nc1d6mvb4bY+u2tSlEUGK8+eG89bzOQtec1ZggUeOqRbPlmUzP+tRf0
oCSWAiHvrn/13dIMFb9Jh1XIFJgs4PpbLtoM70e2FamkU+C57Y2m6D3NILBI
YM4+oABte2fMZclmsF6qoJRmU+Ba2EOh+f3NoLjOWk2FRgH1wzzvmg82w3f6
4M8ZBgWEvntkpcg3w7CzVFZJHgWms97Y2Ss1wwHhI5rehRR4cVHrgKpqM1gG
iT5XKqLA/wA8dYq/
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesOrigin->{0, 0},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotRange->{{-0.1, 0.15}, {-0.002469213306572586, 0.01629329892522989}},
     PlotRangeClipping->True,
     PlotRangePadding->{
       Scaled[0.02], 
       Scaled[0.02]}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{1.05, -0.55}, {1.85, 0.050000000000000086`}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{RectangleBox[{1., -0.5}, {1.8, 0.10000000000000009`}],
         InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[
               {Hue[0.9060679774997897, 0.6, 0.6], 
                LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"Hagan\"\>", {1.2100000000000002`, 0.58}, {-1, 0}, 
              Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[
               {Hue[0.67, 0.6, 0.6], 
                LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"PSABR\"\>", {1.2100000000000002`, 1.74}, {-1, 0}, 
              Automatic, {1, 0}]}}, {}},
          AspectRatio->0.7500000000000001,
          FormatType->TraditionalForm,
          PlotRange->{{-0.1, 3.26}, {-0.1, 2.42}}], {1., -0.5}, {
         Left, Bottom}, {0.8, 0.6000000000000001}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{{3.441971851950221*^9, 3.441971886057413*^9}, {
   3.441973055329899*^9, 3.441973092016929*^9}, 3.4419741254099517`*^9, {
   3.4419741919247255`*^9, 3.4419742140181923`*^9}, 3.4419742933609266`*^9, {
   3.4419743506258187`*^9, 3.441974382484786*^9}, 3.4419744167343473`*^9, 
   3.4419746969495106`*^9, 3.441974740448954*^9, {3.4419748081199627`*^9, 
   3.4419748689316845`*^9}, {3.4419749333527346`*^9, 3.4419749415088806`*^9}, 
   3.4420332178639174`*^9, {3.4420334192754793`*^9, 3.442033454945528*^9}, {
   3.4420335030368156`*^9, 3.4420335144581056`*^9}, 3.4420336000630975`*^9, {
   3.4420362970446053`*^9, 3.442036321544524*^9}, {3.4420363875612373`*^9, 
   3.442036408163086*^9}, 3.442036625433803*^9, 3.4420368255538473`*^9, {
   3.442036870693825*^9, 3.442036875368869*^9}, {3.4420371012688046`*^9, 
   3.4420371071607866`*^9}, {3.4420374942467666`*^9, 
   3.4420375559038057`*^9}, {3.4420377559376163`*^9, 3.442037762718953*^9}, 
   3.442078560026157*^9, 3.442078708908622*^9, 3.442146708407585*^9, 
   3.4421503036041813`*^9, 3.442150391211874*^9, {3.442150500787895*^9, 
   3.4421505202250223`*^9}, 3.442573506499182*^9, 3.442582179822364*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deuxieme Ordre", "Section",
 CellChangeTimes->{{3.4425823996420474`*^9, 3.4425824187194395`*^9}}],

Cell[CellGroupData[{

Cell["Theorie", "Subsection",
 CellChangeTimes->{{3.442661882152302*^9, 3.4426618836209955`*^9}}],

Cell[BoxData[
 RowBox[{"Le", " ", "terme", " ", "de", " ", "premier", " ", "et", " ", 
  "second", " ", "ordre", " ", "diagonal", " ", 
  RowBox[{"sont", " ", ":", " "}]}]], "Input",
 CellChangeTimes->{{3.4425827210515795`*^9, 3.442582732129279*^9}, {
  3.4425829659171762`*^9, 3.4425829749012065`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "1"], 
   RowBox[{"(", "x", ")"}]}], "=", 
  RowBox[{
   RowBox[{"P", 
    RowBox[{"(", "x", ")"}]}], "=", 
   RowBox[{
    FractionBox["R", "6"], "+", "Q"}]}]}]], "Input",
 CellChangeTimes->{{3.4425829533395348`*^9, 3.4425829895725183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "2"], 
   RowBox[{"(", 
    RowBox[{"x", ",", "x"}], ")"}]}], "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "180"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["R", "ijkl"], 
       SuperscriptBox["R", "ijkl"]}], "-", 
      RowBox[{
       SubscriptBox["R", "ij"], 
       SuperscriptBox["R", "ij"]}]}], ")"}]}], " ", "+", 
   FractionBox[
    RowBox[{"P", 
     SuperscriptBox[
      RowBox[{"(", "x", ")"}], "2"]}], "2"], "+", 
   RowBox[{
    FractionBox["1", "12"], 
    SubscriptBox["F", "ij"], 
    SuperscriptBox["F", "ij"]}], "+", 
   RowBox[{
    FractionBox["1", "6"], "\[CapitalDelta]Q"}], "+", 
   RowBox[{
    FractionBox["1", "30"], "\[CapitalDelta]R"}]}]}]], "Input",
 CellChangeTimes->{{3.4425827389258933`*^9, 3.442582812938676*^9}, {
  3.442582948027239*^9, 3.442582949652176*^9}, {3.442583116489519*^9, 
  3.4425831750653954`*^9}, {3.4425834239464626`*^9, 3.4425834452268953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ou", " ", 
   SubscriptBox["F", "ij"]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "i"], 
    SubscriptBox["A", "j"]}], "-", 
   RowBox[{
    SubscriptBox["\[PartialD]", "j"], 
    SubscriptBox["A", "i"]}]}]}]], "Input",
 CellChangeTimes->{{3.4425832249228554`*^9, 3.44258326321826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quand", " ", "R"}], "=", 
  RowBox[{
  "0", " ", "et", " ", "que", " ", "nous", " ", "somme", " ", "en", " ", 
   "dim", " ", "1", " ", "on", " ", "a", " "}]}]], "Input",
 CellChangeTimes->{{3.4425834581170254`*^9, 3.442583488397113*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "1"], 
   RowBox[{"(", "x", ")"}]}], "=", "Q"}]], "Input",
 CellChangeTimes->{{3.442583604502029*^9, 3.442583607892524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "2"], 
   RowBox[{"(", 
    RowBox[{"x", ",", "x"}], ")"}]}], "=", 
  RowBox[{
   FractionBox[
    SuperscriptBox["Q", "2"], "2"], "+", 
   RowBox[{
    FractionBox["1", "6"], "\[CapitalDelta]Q"}]}]}]], "Input",
 CellChangeTimes->{{3.4425834993654413`*^9, 3.4425835124118156`*^9}}],

Cell[BoxData[
 RowBox[{"pour", " ", "le", " ", "cas", " ", "CEV", " ", 
  RowBox[{"on", " ", ":"}]}]], "Input",
 CellChangeTimes->{{3.4425836147047625`*^9, 3.4425836219857326`*^9}, {
  3.4425837685894775`*^9, 3.442583769230078*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "1"], 
   RowBox[{"(", "x", ")"}]}], "=", 
  RowBox[{
   FractionBox["1", "8"], "\[Beta]", 
   RowBox[{"(", 
    RowBox[{"\[Beta]", "-", "2"}], ")"}], 
   SuperscriptBox["fav", 
    RowBox[{
     RowBox[{"2", "\[Beta]"}], "-", "2"}]]}]}]], "Input",
 CellChangeTimes->{{3.442583604502029*^9, 3.442583607892524*^9}, {
  3.442583643500531*^9, 3.4425836854207964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "2"], 
   RowBox[{"(", 
    RowBox[{"x", ",", "x"}], ")"}]}], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"\[Beta]", 
     RowBox[{"(", 
      RowBox[{"\[Beta]", "-", "2"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "\[Beta]"}], "-", "2"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "\[Beta]"}], "-", "4"}], ")"}]}], "128"], 
   SuperscriptBox["fav", 
    RowBox[{
     RowBox[{"4", "\[Beta]"}], "-", "4"}]]}]}]], "Input",
 CellChangeTimes->{{3.4425834993654413`*^9, 3.4425835124118156`*^9}, {
  3.442583697560955*^9, 3.4425837553243623`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Second ordre avec avec approximation sans courbure pour le second ordre\
\>", "Subsection",
 CellChangeTimes->{{3.4426618123424826`*^9, 3.4426618494035597`*^9}, {
   3.4426672304469194`*^9, 3.4426672331030674`*^9}, 3.4426684078079567`*^9}],

Cell[BoxData[
 RowBox[{"we", " ", "assume", " ", "that"}]], "Input",
 CellChangeTimes->{{3.442667257352136*^9, 3.4426672603363967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"\[Tau]", ",", "K", ",", 
      RowBox[{"a", "|", "0"}], ",", "f", ",", "\[Alpha]"}], ")"}]}], "=", 
   RowBox[{
    FractionBox[
     SqrtBox[
      RowBox[{"g", "[", 
       RowBox[{"f", ",", " ", "\[Alpha]"}], "]"}]], 
     RowBox[{"4", "\[Pi]", " ", "\[Tau]"}]], 
    SqrtBox[
     RowBox[{"\[CapitalDelta]", "[", 
      RowBox[{"K", ",", "a", ",", "f", ",", "\[Alpha]"}], "]"}]], 
    RowBox[{"P", "[", 
     RowBox[{"f", ",", "\[Alpha]", ",", "K", ",", "a"}], "]"}]}]}], ",", 
  RowBox[{
   SuperscriptBox["a\[ExponentialE]", 
    FractionBox[
     RowBox[{"-", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"K", ",", "f"}], "]"}]}], 
     RowBox[{"2", "\[Tau]"}]]], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"a1", "[", 
       RowBox[{"K", ",", "a", ",", "f", ",", "\[Alpha]"}], "]"}], " ", 
      "\[Tau]"}], "+", 
     RowBox[{
      RowBox[{"a2", "[", 
       RowBox[{"K", ",", "a", ",", "f", ",", "\[Alpha]"}], "]"}], " ", 
      SuperscriptBox["\[Tau]", "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4426672654299507`*^9, 3.4426673495829697`*^9}, {
  3.4426675526689205`*^9, 3.442667738693027*^9}, {3.4426681013666*^9, 
  3.442668140505722*^9}, {3.4426682137372847`*^9, 3.442668256345023*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "1"], 
   RowBox[{"(", "x", ")"}]}], "=", 
  RowBox[{
   FractionBox["R", "6"], "+", "Q"}]}]], "Input",
 CellChangeTimes->{{3.442583604502029*^9, 3.442583607892524*^9}, 
   3.442669406660225*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["a", "2"], 
   RowBox[{"(", 
    RowBox[{"x", ",", "x"}], ")"}]}], "=", 
  RowBox[{
   FractionBox[
    SuperscriptBox["Q", "2"], "2"], "+", 
   RowBox[{
    FractionBox["1", "6"], "\[CapitalDelta]Q"}]}]}]], "Input",
 CellChangeTimes->{{3.4425834993654413`*^9, 3.4425835124118156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"labordere", " ", "p137"}], ")"}], "  ", "By", " ", "the", " ", 
  "Tanaka", " ", "formula", " ", "we", " ", 
  RowBox[{"get", " ", ":", " "}]}]], "Input",
 CellChangeTimes->{{3.4426672434307957`*^9, 3.442667252102338*^9}, {
  3.4426678331581497`*^9, 3.442667843688995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Call", "[", 
   RowBox[{"T", ",", 
    RowBox[{"K", "|", "F0"}]}], "]"}], "=", 
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"F0", "-", "K"}], ",", "0"}], "]"}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "T"], 
     RowBox[{
      RowBox[{"\[DifferentialD]", "\[Tau]"}], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
       RowBox[{
        RowBox[{"\[DifferentialD]", "a"}], " ", 
        SuperscriptBox["a", "2"], "p", 
        RowBox[{"(", 
         RowBox[{"\[Tau]", ",", "K", " ", ",", 
          RowBox[{"a", "|", "0"}], ",", "f", ",", "\[Alpha]"}], 
         ")"}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.4426678964213448`*^9, 3.442667937904127*^9}, {
   3.442667967918599*^9, 3.4426680146355553`*^9}, {3.442668061961863*^9, 
   3.4426680808048897`*^9}, 3.4426682793597646`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation :", "Subsection",
 CellChangeTimes->{{3.4426618123424826`*^9, 3.4426618494035597`*^9}, {
  3.4426683993082833`*^9, 3.442668402730027*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StochVolBSVol", "[", 
   RowBox[{
   "CC_", ",", "CCDev1_", ",", "CCDev2_", ",", "CCInvInteg_", ",", "\[Rho]_", 
    ",", "\[Nu]_", ",", "F_", ",", "K_", ",", "T_", ",", "fav_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w", ",", "H1", ",", "H2", ",", "Q", ",", "b1", ",", "b2", ",", "b3", 
      ",", "x", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b1", "=", 
      RowBox[{
       FractionBox["1", "24"], " ", 
       SuperscriptBox["\[Nu]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"CCDev1", "[", "fav", "]"}], " ", "\[Nu]", " ", "\[Rho]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "[", "fav", "]"}], ")"}], "2"], "24"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", 
           RowBox[{"CCDev2", "[", "fav", "]"}]}], 
          RowBox[{"CC", "[", "fav", "]"}]], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"CCDev1", "[", "fav", "]"}], 
            RowBox[{"CC", "[", "fav", "]"}]], ")"}], "2"], "+", 
         FractionBox["1", 
          SuperscriptBox["fav", "2"]]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CCInvInteg", "[", "F", "]"}], "-", 
        RowBox[{"CCInvInteg", "[", "K", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"F", "-", "K"}], "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"CC", "[", "F", "]"}], "]"}], " "}], "F"], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"Log", "[", 
           RowBox[{"F", "/", "K"}], "]"}], "x"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441963296725667*^9, 3.441963327428399*^9}, {
   3.441963389505729*^9, 3.441963433145796*^9}, {3.4419635367382193`*^9, 
   3.4419635406444197`*^9}, 3.4419636689084024`*^9, {3.4419644307111516`*^9, 
   3.441964435148595*^9}, {3.4419644828511095`*^9, 3.4419644895853977`*^9}, {
   3.441971445865712*^9, 3.4419714557236357`*^9}, {3.4420365651973877`*^9, 
   3.442036575498312*^9}, {3.4420506925084105`*^9, 3.442050693227147*^9}, {
   3.442050818349745*^9, 3.442050839958705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StochVolNormVol", "[", 
   RowBox[{
   "CC_", ",", "CCDev1_", ",", "CCDev2_", ",", "CCInvInteg_", ",", "\[Rho]_", 
    ",", "\[Nu]_", ",", "F_", ",", "K_", ",", "T_", ",", "fav_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w", ",", "H1", ",", "H2", ",", "Q", ",", "b1", ",", "b2", ",", "b3", 
      ",", "x", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b1", "=", 
      RowBox[{
       FractionBox["1", "24"], " ", 
       SuperscriptBox["\[Nu]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ";", 
     RowBox[{"b2", "=", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"CCDev1", "[", "fav", "]"}], " ", "\[Nu]", " ", "\[Rho]"}]}], 
     ";", 
     RowBox[{"b3", "=", 
      RowBox[{
       FractionBox["1", "24"], "  ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"CCDev2", "[", "fav", "]"}], 
          RowBox[{"CC", "[", "fav", "]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"CCDev1", "[", "fav", "]"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"CC", "[", "fav", "]"}], "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{
       RowBox[{"CCInvInteg", "[", "F", "]"}], "-", 
       RowBox[{"CCInvInteg", "[", "K", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"F", "-", "K"}], "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], ",", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"CC", "[", "F", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"K", "-", "F"}], "x"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"T", " ", 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2", "+", "b3"}], ")"}]}]}], ")"}]}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4420337393372164`*^9, 3.4420337501960354`*^9}, 
   3.4420361516355753`*^9, {3.4420361860088153`*^9, 3.4420362870098147`*^9}, {
   3.442036383068281*^9, 3.4420364038266783`*^9}, {3.4420364589475813`*^9, 
   3.4420364901008325`*^9}, {3.442036533856278*^9, 3.442036546348888*^9}, {
   3.442050519324236*^9, 3.442050653306039*^9}, {3.442580840701913*^9, 
   3.442580908371189*^9}, {3.4425812387022543`*^9, 3.442581245842605*^9}, 
   3.4425812759351997`*^9, {3.442581675747971*^9, 3.4425816797946906`*^9}, {
   3.442581725589807*^9, 3.4425817401829967`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Anexe", "Section",
 CellChangeTimes->{{3.4426617934994564`*^9, 3.4426617977336683`*^9}}],

Cell[CellGroupData[{

Cell["Anexe : Second ordre selon avramidi", "Subsection",
 CellChangeTimes->{{3.442661768562914*^9, 3.442661781734283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"Tanh", "[", "x", "]"}]}], "-", 
   RowBox[{"1", "/", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.4425882710259523`*^9, 3.4425883108212996`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H0", "[", "x_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"n", "-", "1", "-", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"n", "-", "3"}], ")"}], "x"], 
     RowBox[{"f", "[", "x", "]"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.442588337820263*^9, 3.4425884307854424`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"H0", "[", "x", "]"}], ",", "x"}], "]"}], "-", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "2"], 
    RowBox[{"f", "[", "x", "]"}], 
    RowBox[{"H0", "[", "x", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.442588437144573*^9, 3.44258848528335*^9}, {
  3.442588609622325*^9, 3.4425886130284443`*^9}, {3.4425886749166927`*^9, 
  3.442588681416443*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"x", " ", 
       RowBox[{"Coth", "[", "x", "]"}]}]}], ")"}]}], 
   SuperscriptBox["x", "3"]], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "x"]}], "+", 
     RowBox[{"Coth", "[", "x", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n", "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"x", " ", 
          RowBox[{"Coth", "[", "x", "]"}]}]}], ")"}]}], 
      SuperscriptBox["x", "2"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Csch", "[", "x", "]"}], "2"]}]}], ")"}]}], 
   SuperscriptBox["x", "3"]]}]], "Output",
 CellChangeTimes->{3.442588488923835*^9, 3.442588614887748*^9, 
  3.4425886828382635`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"H1", "[", "x_", "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"Coth", "[", "x", "]"}]}]}], ")"}]}], 
    SuperscriptBox["x", "3"]], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "x"]}], "+", 
      RowBox[{"Coth", "[", "x", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"x", " ", 
           RowBox[{"Coth", "[", "x", "]"}]}]}], ")"}]}], 
       SuperscriptBox["x", "2"]]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["x", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csch", "[", "x", "]"}], "2"]}]}], ")"}]}], 
    SuperscriptBox["x", "3"]]}]}]], "Input",
 CellChangeTimes->{{3.4425884919862175`*^9, 3.442588504595108*^9}, 
   3.4425886231686797`*^9, 3.442588690916078*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"H1", "[", "x", "]"}], ",", "x"}], "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "2"], 
       RowBox[{"f", "[", "x", "]"}]}], "+", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "x"]}], ")"}], 
    RowBox[{"H1", "[", "x", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.442588518438327*^9, 3.4425885894668493`*^9}, {
  3.4425886519800735`*^9, 3.4425886577298527`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox["x", "4"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"35", "+", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{
        SuperscriptBox["n", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["x", "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", "n", "-", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{"n", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Coth", "[", "x", "]"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox[
      RowBox[{"Coth", "[", "x", "]"}], "3"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"21", "+", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{
        SuperscriptBox["n", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          SuperscriptBox["x", "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"8", "+", 
          SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Csch", "[", "x", "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "x", " ", 
     RowBox[{"Coth", "[", "x", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"15", "-", 
       RowBox[{"8", " ", "n"}], "+", 
       SuperscriptBox["n", "2"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "n"}], ")"}], " ", 
        SuperscriptBox["x", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csch", "[", "x", "]"}], "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.442588630105913*^9, 3.442588659964142*^9}, 
   3.442588695853389*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "[", "x_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"35", "+", 
        SuperscriptBox["x", "2"], "+", 
        RowBox[{
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"]}], ")"}]}], "-", 
        RowBox[{"2", " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{"6", "+", 
           SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "n", "-", 
        SuperscriptBox["x", "2"], "+", 
        RowBox[{"n", " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Coth", "[", "x", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
      SuperscriptBox["x", "3"], " ", 
      SuperscriptBox[
       RowBox[{"Coth", "[", "x", "]"}], "3"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"21", "+", 
        SuperscriptBox["x", "2"], "+", 
        RowBox[{
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           SuperscriptBox["x", "2"]}], ")"}]}], "-", 
        RowBox[{"2", " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{"8", "+", 
           SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Csch", "[", "x", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "x", " ", 
      RowBox[{"Coth", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"15", "-", 
        RowBox[{"8", " ", "n"}], "+", 
        SuperscriptBox["n", "2"], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "n"}], ")"}], " ", 
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Csch", "[", "x", "]"}], "2"]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4425886395743*^9, 3.442588669151289*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", 
   RowBox[{"\[Rho]", " ", "r"}]], 
  RowBox[{"x", " ", 
   RowBox[{"B", "[", "x", "]"}], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.4425887233992057`*^9, 3.4425887513981304`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"(", 
      RowBox[{"93", "-", 
       RowBox[{"127", " ", "n"}], "+", 
       RowBox[{"59", " ", 
        SuperscriptBox["n", "2"]}], "-", 
       RowBox[{"9", " ", 
        SuperscriptBox["n", "3"]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox["\[Rho]", "2"]}]], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Csch", "[", 
        RowBox[{"r", " ", "\[Rho]"}], "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"105", "-", 
        RowBox[{"71", " ", "n"}], "+", 
        RowBox[{"15", " ", 
         SuperscriptBox["n", "2"]}], "-", 
        SuperscriptBox["n", "3"], "+", 
        RowBox[{"30", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"14", " ", "n", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "-", 
        RowBox[{"14", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "-", 
        RowBox[{"3", " ", "n", " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "-", 
        RowBox[{
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "105"}], "-", 
           RowBox[{
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox["\[Rho]", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["n", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"5", "+", 
              RowBox[{
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{"71", "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "r", " ", "\[Rho]", 
         " ", 
         RowBox[{"(", 
          RowBox[{"15", "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            SuperscriptBox["\[Rho]", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}]}], ")"}]}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.4425888109583435`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "\[Rho]"}], 
     RowBox[{"2", 
      SuperscriptBox["r", "2"]}]]}], 
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{"93", "-", 
        RowBox[{"127", " ", "n"}], "+", 
        RowBox[{"59", " ", 
         SuperscriptBox["n", "2"]}], "-", 
        RowBox[{"9", " ", 
         SuperscriptBox["n", "3"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Rho]", "2"]}]], 
      SuperscriptBox[
       RowBox[{"Csch", "[", 
        RowBox[{"r", " ", "\[Rho]"}], "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"105", "-", 
        RowBox[{"71", " ", "n"}], "+", 
        RowBox[{"15", " ", 
         SuperscriptBox["n", "2"]}], "-", 
        SuperscriptBox["n", "3"], "+", 
        RowBox[{"30", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"14", " ", "n", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "-", 
        RowBox[{"14", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "-", 
        RowBox[{"3", " ", "n", " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "-", 
        RowBox[{
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "105"}], "-", 
           RowBox[{
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox["\[Rho]", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["n", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"5", "+", 
              RowBox[{
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{"71", "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "r", " ", "\[Rho]", 
         " ", 
         RowBox[{"(", 
          RowBox[{"15", "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            SuperscriptBox["\[Rho]", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4425889222509446`*^9, 3.442588968905403*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"8", " ", 
     SuperscriptBox["r", "2"]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Rho]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{"93", "-", 
         RowBox[{"127", " ", "n"}], "+", 
         RowBox[{"59", " ", 
          SuperscriptBox["n", "2"]}], "-", 
         RowBox[{"9", " ", 
          SuperscriptBox["n", "3"]}]}], ")"}]}], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}]], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Csch", "[", 
          RowBox[{"r", " ", "\[Rho]"}], "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"105", "-", 
          RowBox[{"71", " ", "n"}], "+", 
          RowBox[{"15", " ", 
           SuperscriptBox["n", "2"]}], "-", 
          SuperscriptBox["n", "3"], "+", 
          RowBox[{"30", " ", 
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Rho]", "2"]}], "+", 
          RowBox[{"14", " ", "n", " ", 
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Rho]", "2"]}], "-", 
          RowBox[{"14", " ", 
           SuperscriptBox["n", "2"], " ", 
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Rho]", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["n", "3"], " ", 
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Rho]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["r", "4"], " ", 
           SuperscriptBox["\[Rho]", "4"]}], "-", 
          RowBox[{"3", " ", "n", " ", 
           SuperscriptBox["r", "4"], " ", 
           SuperscriptBox["\[Rho]", "4"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["n", "2"], " ", 
           SuperscriptBox["r", "4"], " ", 
           SuperscriptBox["\[Rho]", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["n", "3"], " ", 
           SuperscriptBox["r", "4"], " ", 
           SuperscriptBox["\[Rho]", "4"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "105"}], "-", 
             RowBox[{
              SuperscriptBox["r", "4"], " ", 
              SuperscriptBox["\[Rho]", "4"]}], "+", 
             RowBox[{
              SuperscriptBox["n", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["r", "4"], " ", 
                 SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["n", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"5", "+", 
                RowBox[{
                 SuperscriptBox["r", "4"], " ", 
                 SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "+", 
             RowBox[{"n", " ", 
              RowBox[{"(", 
               RowBox[{"71", "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["r", "4"], " ", 
                 SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"Cosh", "[", 
            RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "r", " ", "\[Rho]", 
           " ", 
           RowBox[{"(", 
            RowBox[{"15", "+", 
             RowBox[{
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Rho]", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{"4", "+", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}]}], ")"}]}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.442588932438053*^9, 3.442588980983064*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"b2", "[", 
   RowBox[{"n_", ",", "\[Rho]_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"8", " ", 
      SuperscriptBox["r", "2"]}]]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Rho]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{"93", "-", 
        RowBox[{"127", " ", "n"}], "+", 
        RowBox[{"59", " ", 
         SuperscriptBox["n", "2"]}], "-", 
        RowBox[{"9", " ", 
         SuperscriptBox["n", "3"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Rho]", "2"]}]], 
      SuperscriptBox[
       RowBox[{"Csch", "[", 
        RowBox[{"r", " ", "\[Rho]"}], "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"105", "-", 
        RowBox[{"71", " ", "n"}], "+", 
        RowBox[{"15", " ", 
         SuperscriptBox["n", "2"]}], "-", 
        SuperscriptBox["n", "3"], "+", 
        RowBox[{"30", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"14", " ", "n", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "-", 
        RowBox[{"14", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "-", 
        RowBox[{"3", " ", "n", " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "-", 
        RowBox[{
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox["\[Rho]", "4"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "105"}], "-", 
           RowBox[{
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox["\[Rho]", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["n", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"5", "+", 
              RowBox[{
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{"71", "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "4"], " ", 
               SuperscriptBox["\[Rho]", "4"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "r", " ", "\[Rho]", 
         " ", 
         RowBox[{"(", 
          RowBox[{"15", "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            SuperscriptBox["\[Rho]", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{"2", " ", "r", " ", "\[Rho]"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4425888666593294`*^9, 3.4425888959238305`*^9}, 
   3.442588994560668*^9}],

Cell[BoxData[
 RowBox[{"n", "=", "2"}]], "Input",
 CellChangeTimes->{{3.4425913792190933`*^9, 3.442591380156557*^9}}],

Cell[BoxData[
 RowBox[{"b1", "=", 
  RowBox[{
   FractionBox["1", "4"], 
   SuperscriptBox["\[Rho]", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], 
        SuperscriptBox["r", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "r", " ", 
         RowBox[{"Coth", "[", 
          RowBox[{"\[Rho]", " ", "r"}], "]"}]}], "-", "1"}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.442591382984574*^9, 3.442591487824298*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1039, 859},
WindowMargins->{{114, Automatic}, {Automatic, -6}},
ShowSelection->True,
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 77, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[647, 25, 109, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[781, 30, 104, 1, 36, "Subsection"],
Cell[888, 33, 3940, 113, 309, "Input",
 InitializationCell->True],
Cell[4831, 148, 1898, 53, 182, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6766, 206, 106, 1, 36, "Subsection"],
Cell[6875, 209, 3768, 103, 294, "Input",
 InitializationCell->True],
Cell[10646, 314, 3470, 92, 188, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14165, 412, 99, 1, 71, "Section"],
Cell[14267, 415, 4352, 118, 279, "Input",
 InitializationCell->True],
Cell[18622, 535, 560, 14, 31, "Input",
 InitializationCell->True],
Cell[19185, 551, 1606, 37, 112, "Input",
 InitializationCell->True],
Cell[20794, 590, 4494, 114, 281, "Input",
 InitializationCell->True],
Cell[25291, 706, 609, 14, 31, "Input",
 InitializationCell->True],
Cell[25903, 722, 1664, 38, 112, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[27604, 765, 149, 2, 71, "Section"],
Cell[27756, 769, 353, 8, 31, "Input",
 InitializationCell->True],
Cell[28112, 779, 419, 10, 31, "Input",
 InitializationCell->True],
Cell[28534, 791, 475, 12, 31, "Input",
 InitializationCell->True],
Cell[29012, 805, 535, 14, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[29572, 823, 97, 1, 36, "Subsection"],
Cell[29672, 826, 2260, 48, 112, "Input",
 InitializationCell->True],
Cell[31935, 876, 849, 18, 31, "Input",
 InitializationCell->True],
Cell[32787, 896, 1589, 37, 112, "Input",
 InitializationCell->True],
Cell[34379, 935, 2125, 49, 112, "Input",
 InitializationCell->True],
Cell[36507, 986, 791, 17, 31, "Input",
 InitializationCell->True],
Cell[37301, 1005, 1683, 40, 112, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39009, 1049, 1427, 33, 52, "Input"],
Cell[40439, 1084, 10150, 173, 236, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50626, 1262, 1483, 34, 52, "Input"],
Cell[52112, 1298, 9711, 165, 226, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61884, 1470, 98, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[62007, 1475, 112, 1, 36, "Subsection"],
Cell[62122, 1478, 508, 11, 31, "Input",
 InitializationCell->True],
Cell[62633, 1491, 550, 13, 31, "Input",
 InitializationCell->True],
Cell[63186, 1506, 606, 15, 31, "Input",
 InitializationCell->True],
Cell[63795, 1523, 939, 24, 54, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[64771, 1552, 97, 1, 36, "Subsection"],
Cell[64871, 1555, 1641, 38, 112, "Input",
 InitializationCell->True],
Cell[66515, 1595, 1523, 36, 112, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68087, 1637, 105, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[68217, 1642, 112, 1, 36, "Subsection"],
Cell[68332, 1645, 1093, 29, 69, "Input",
 InitializationCell->True],
Cell[69428, 1676, 2006, 57, 104, "Input",
 InitializationCell->True],
Cell[71437, 1735, 3976, 114, 309, "Input",
 InitializationCell->True],
Cell[75416, 1851, 1526, 41, 68, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[76979, 1897, 97, 1, 36, "Subsection"],
Cell[77079, 1900, 2402, 52, 112, "Input",
 InitializationCell->True],
Cell[79484, 1954, 850, 18, 31, "Input",
 InitializationCell->True],
Cell[80337, 1974, 1651, 38, 112, "Input",
 InitializationCell->True],
Cell[81991, 2014, 2130, 48, 112, "Input",
 InitializationCell->True],
Cell[84124, 2064, 747, 16, 31, "Input",
 InitializationCell->True],
Cell[84874, 2082, 1642, 38, 112, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[86541, 2124, 1714, 37, 52, "Input"],
Cell[88258, 2163, 10536, 179, 237, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98831, 2347, 1719, 37, 52, "Input"],
Cell[100553, 2386, 9923, 168, 226, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110513, 2559, 1791, 38, 52, "Input"],
Cell[112307, 2599, 12635, 213, 237, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125003, 2819, 99, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[125127, 2824, 112, 1, 36, "Subsection"],
Cell[125242, 2827, 1429, 39, 55, "Input",
 InitializationCell->True],
Cell[126674, 2868, 1666, 46, 57, "Input",
 InitializationCell->True],
Cell[128343, 2916, 4014, 112, 130, "Input",
 InitializationCell->True],
Cell[132360, 3030, 1842, 52, 77, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[134239, 3087, 97, 1, 36, "Subsection"],
Cell[134339, 3090, 2668, 55, 112, "Input",
 InitializationCell->True],
Cell[137010, 3147, 977, 20, 31, "Input",
 InitializationCell->True],
Cell[137990, 3169, 1827, 41, 112, "Input",
 InitializationCell->True],
Cell[139820, 3212, 2300, 50, 112, "Input",
 InitializationCell->True],
Cell[142123, 3264, 923, 19, 31, "Input",
 InitializationCell->True],
Cell[143049, 3285, 1829, 42, 112, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[144903, 3331, 2285, 49, 72, "Input"],
Cell[147191, 3382, 11906, 208, 172, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159134, 3595, 2897, 58, 72, "Input"],
Cell[162034, 3655, 19836, 336, 172, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181931, 3998, 103, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[182059, 4003, 97, 1, 36, "Subsection"],
Cell[182159, 4006, 303, 5, 31, "Input"],
Cell[182465, 4013, 298, 10, 47, "Input"],
Cell[182766, 4025, 985, 31, 50, "Input"],
Cell[183754, 4058, 341, 11, 31, "Input"],
Cell[184098, 4071, 273, 6, 31, "Input"],
Cell[184374, 4079, 180, 5, 31, "Input"],
Cell[184557, 4086, 337, 11, 50, "Input"],
Cell[184897, 4099, 232, 4, 31, "Input"],
Cell[185132, 4105, 421, 13, 47, "Input"],
Cell[185556, 4120, 640, 21, 47, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186233, 4146, 249, 4, 36, "Subsection"],
Cell[186485, 4152, 136, 2, 31, "Input"],
Cell[186624, 4156, 1324, 37, 52, "Input"],
Cell[187951, 4195, 251, 8, 47, "Input"],
Cell[188205, 4205, 337, 11, 50, "Input"],
Cell[188545, 4218, 325, 7, 31, "Input"],
Cell[188873, 4227, 935, 26, 47, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189845, 4258, 159, 2, 36, "Subsection"],
Cell[190007, 4262, 3768, 103, 294, "Input",
 InitializationCell->True],
Cell[193778, 4367, 3470, 92, 188, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197297, 4465, 94, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[197416, 4470, 123, 1, 36, "Subsection"],
Cell[197542, 4473, 253, 7, 31, "Input"],
Cell[197798, 4482, 335, 10, 47, "Input"],
Cell[CellGroupData[{
Cell[198158, 4496, 498, 14, 47, "Input"],
Cell[198659, 4512, 1424, 51, 51, "Output"]
}, Open  ]],
Cell[200098, 4566, 1552, 53, 51, "Input"],
Cell[CellGroupData[{
Cell[201675, 4623, 614, 19, 47, "Input"],
Cell[202292, 4644, 2516, 81, 71, "Output"]
}, Open  ]],
Cell[204823, 4728, 2618, 82, 91, "Input"],
Cell[CellGroupData[{
Cell[207466, 4814, 276, 7, 44, "Input"],
Cell[207745, 4823, 3996, 112, 144, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211778, 4940, 4233, 119, 209, "Input"],
Cell[216014, 5061, 4412, 119, 147, "Output"]
}, Open  ]],
Cell[220441, 5183, 4308, 121, 202, "Input"],
Cell[224752, 5306, 117, 2, 31, "Input"],
Cell[224872, 5310, 552, 18, 49, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
